! ============
! controls_dev
! ============

! .. warning::
!
!  CONTAINS OPTIONS THAT HAVE NOT YET BEEN THE GIVEN A GREEN LIGHT FOR GENERAL USE.
!  IN PARTICULAR, THESE ARE NOT YET FOR USE IN RESEARCH TO BE PUBLISHED.

      ! TDC options
      ! ~~~~~~~~~~~
      ! ::

      compare_TDC_to_MLT = .false.

      ! RSP2 parameters
      ! ~~~~~~~~~~~~~~~

      !|   RSP2_alfad =     1.0d0         ! turbulent dissipation; damp ~ RSP2_alfad
      !|   RSP2_alfap =     0.0d0         ! turbulent pressure; Pt ~ alfap
      !|   RSP2_alfat =     0.0d0         ! turbulent flux; Lt ~ RSP2_alfat
      !|   RSP2_alfam =     0.25d0        ! turbulent viscosity; Eq and Uq ~ RSP2_alfam
      !|   RSP2_alfar =     0.0d0         ! radiative dissipation of turbulent energy; Dr ~ RSP2_alfar
      !
      ! RSP2 time weighting is determined by the velocity_time_centering controls.
      !
      !     + for Pt and Lt in turbulent energy equation
      !     + for P and grav in momentum equation
      !     + for P and L in energy equation
      !     + for area when multiplied by P
      !
      ! RSP2_Lsurf_factor: Lsurf = RSP2_Lsurf_factor*area(1)*clight*crad*T(1)**4
      ! RSP2_use_Stellingwerf_Lr as in RSP
      !

      ! ::

    RSP2_alfad = 1.0d0
    RSP2_alfap = 0.0d0
    RSP2_alfat = 0.0d0
    RSP2_alfam = 0.25d0
    RSP2_alfar = 0.0d0

    RSP2_min_Lt_div_L_for_overshooting_mixing_type = 1d-4
    RSP2_min_Lc_div_L_for_convective_mixing_type = 1d-4

    RSP2_Lsurf_factor = 0.5d0

    RSP2_report_adjust_w = .false.
    RSP2_use_L_eqn_at_surface = .true.
    RSP2_assume_HSE = .true.
    RSP2_use_RSP_eqn_for_Y_face = .true.
    RSP2_use_mass_interp_face_values = .false.
    RSP2_use_Stellingwerf_Lr = .true.

    RSP2_num_outermost_cells_forced_nonturbulent = 0
    RSP2_num_innermost_cells_forced_nonturbulent = 0

   RSP2_w_fix_if_neg = 5d-5
   RSP2_w_min_for_damping = 1d2
   RSP2_source_seed = 0d0

   RSP2_remesh_when_load = .true.

   RSP2_nz = 150
   RSP2_nz_outer = 40
   RSP2_T_anchor = 11d3
   RSP2_dq_1_factor = 2d0

   RSP2_nz_div_IBOTOM = 30d0


      ! period controls

      ! ::

    RSP2_target_steps_per_cycle = 600
    RSP2_min_max_R_for_periods = -1

      ! when to stop

      ! ::

    RSP2_max_num_periods = -1
    RSP2_GREKM_avg_abs_frac_new = 0.1d0
    RSP2_GREKM_avg_abs_limit = -1

      ! output data for work integrals during a particular period

      ! ::

    RSP2_work_period = -1
    RSP2_work_filename = 'work.data'

      ! output data for 3d map.  format same as for gnuplot pm3d

      ! ::

    RSP2_write_map = .false.
    RSP2_map_columns_filename = 'map_columns.list'

      ! items listed in your map columns must also appear in your profile columns

      ! ::

    RSP2_map_filename = 'map.data'
    RSP2_map_first_period = -1
    RSP2_map_last_period = -1
    RSP2_map_zone_interval = 2
    RSP2_map_history_filename = 'map_history.data'


! mass corrections
! ================


      ! use_mass_corrections
      ! ~~~~~~~~~~~~~~~~~~~~

      ! Gravitational vs baryonic mass corrections.

      ! The Lagrangian coordinate (:math:`m`) in MESA is the baryonic
      ! mass and the density (:math:`\rho`) is the baryonic mass
      ! density.

      ! If false, then no distinction between gravitational and baryonic mass.
      ! If true, then the gravitational mass is calculated using mass corrections
      ! and the momentum equation, total energy equation, and Brunt are modified.

      ! The variable ``mass_correction`` is the quantity you multiply
      ! the baryonic mass density by to get the gravitational mass
      ! density:

      !     (mass density) = (baryon density) * amu * mass_correction

      ! Given the mass fractions in a cell, the value of
      ! mass_correction is provided by the ``chem`` module.

      ! MESA holds m_grav fixed during the newton iterations.  This results
      ! in an energy conservation error, because the specific potential energy
      ! changes when m_grav is updated afterwards.  A message showing
      ! the relative energy error incurred due to this assumption
      ! will be printed to the terminal.

      ! Not compatible with RSP.

      ! ::

    use_mass_corrections = .false.


      ! phase_separation_no_diffusion
      ! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

      ! if true and element diffusion is on, prevent element diffusion
      ! from occurring in the layers where phase separation mixing
      ! is present (experimental)

      ! ::

    phase_separation_no_diffusion = .false.


! split burn
! ==========


      ! op_split_burn_min_T_for_variable_T_solver
      ! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

      ! use variable T, constant density solver for op_split_burn in cells with T >= this limit at start of step.
      ! only adopted in cells with T >= op_split_burn_min_T at start of step.

      ! ::

    op_split_burn_min_T_for_variable_T_solver = 1d99


! TDC
! ===


      ! alpha_TDC_DAMPM
      ! ~~~~~~~~~~~~~~~
      ! alpha_TDC_C
      ! ~~~~~~~~~~~
      ! alpha_TDC_S
      ! ~~~~~~~~~~~
      ! TDC_use_density_form_for_eddy_viscosity
      ! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


      ! If ``alpha_TDC_DAMPM>0``, then include eddy viscous damping in TDC ``alpha_TDC_DAMPM``
      ! This control is analogous to ``RSP_alfam``, where the default is ``RSP_alfam = 0.25d0``.

      ! If hydrostatic (``v_flag``, ``u_flag = .false.``, ``v = 0`` ) there are no velocity gradients,
      ! and thus no shear to drive turbulence. Without shear, the eddy viscosity term becomes zero.

      ! ``alpha_TDC_C`` and ``alpha_TDC_S`` are pre-factors to scale the flux and source terms.

      ! If ``u_flag = .true.`` or ``TDC_use_density_form_for_eddy_viscosity = .true.``, use density
      ! derivative from newton solver to form d(v/r)/dr, used to compute Eq and Uq.

      ! ::

    alpha_TDC_DAMPM = 0d0
    alpha_TDC_C = 1.0d0
    alpha_TDC_S = 1.0d0
    TDC_use_density_form_for_eddy_viscosity = .false.


      ! TDC_include_eturb_in_energy_equation
      ! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

      ! calculates and incorporates det/dt from TDC as a negative source term in
      ! the total energy equation, along with the eddy viscous heating Eq

      ! ::

    TDC_include_eturb_in_energy_equation = .false.

      ! use_rsp_form_of_scale_height
      ! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~

      ! calculate scale height by averaging P/rho onto faces together instead
      ! of of wrapping P and rho separately by default. Both forms assume HSE.

      ! ::

      use_rsp_form_of_scale_height = .false.


      ! use_RSP_L_eqn_outer_BC
      ! ~~~~~~~~~~~~~~~~~~~~~~

      ! use RSP2 luminosity equation
      ! as the outer boundary condition on L rather than the
      ! default atmospheric BC for temperature.
      ! solves L1 - s% RSP2_Lsurf_factor*4*pi*r^2*c*a*T1^4 = 0
      ! uses dev control s% RSP2_Lsurf_factor  = 0.5 (default),
      ! see controls_dev.defaults.list

      ! ::

    use_RSP_L_eqn_outer_BC = .false.


      ! TDC_num_innermost_cells_forced_nonturbulent
      ! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

      ! Forces innermost TDC_num_innermost_cells_forced_nonturbulent cells
      ! to be nonturbulent, and sets gradT = gradr in these cells.
      ! Useful for pulsation models in TDC.

      ! ::

    TDC_num_innermost_cells_forced_nonturbulent = 0


      ! include_mlt_corr_to_TDC
      ! ~~~~~~~~~~~~~~~~~~~~~~~

      ! If include_mlt_corr_to_TDC = .true. , mlt correction to TDC follows MESA VI (Jermyn et a. 2023)
      ! in which we correct TDC on long timescales with Y_face ~ Y*Gamma/(1+Gamma). If .false., abandon
      ! mlt limit of tdc and adopt original form of (KuhfuÃŸ 1986) convection model in the local limit.

      ! ::

    include_mlt_corr_to_TDC = .true.


      ! include_mlt_Pturb_in_thermodynamic_gradients
      ! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

      ! If mlt_Pturb_factor > 0, includes the effect of turbulent pressure Pturb
      ! on thermodynamic gradients gradr, grada, and hence gradT.
      ! Not supported by other_alpha_mlt or starspots

      ! ::

    include_mlt_Pturb_in_thermodynamic_gradients = .false.


      ! include_mlt_in_velocity_time_centering
      ! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

      ! If doing velocity time_centering, include time centering in mlt. Depending on the time
      ! centering flags adopted, include_mlt_in_velocity_time_centering includes time centering
      ! for P, L, and r in geff, gradr, grada, and mlt.

      ! ::

    include_mlt_in_velocity_time_centering = .false.


      ! remesh_for_TDC_pulsations_log_core_zoning
      ! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

      ! If remesh_for_TDC_pulsations, .true. will rezone below RSP2_Tanchor with logarithmic
      ! spacing in mass. If .false., remeshing scheme will do a bisection root find such
      ! that each zone increases in mass inward following a power law.

      ! ::

      ! Remeshing parameters
      ! ~~~~~~~~~~~~~~~~~~~~

    remesh_for_TDC_pulsations_log_core_zoning = .false.
    TDC_hydro_use_mass_interp_face_values = .false.

    TDC_hydro_nz = 150
    TDC_hydro_nz_outer = 40
    TDC_hydro_T_anchor = 11d3
    TDC_hydro_dq_1_factor = 2d0
