&kap

/

&eos

/

&star_job
   create_pre_main_sequence_model = .false.

   save_model_when_terminate = .true.
   save_model_filename = 'remeshed.mod'
   !required_termination_code_string = 'Successful test: evolved 100 days past first relax'

   load_saved_model = .true.
   load_model_filename = 'he_dep.mod'

!relax_Y = .true.
!change_Y = .true.
!new_Y = 0.267d0

!relax_Z = .true.
!change_Z = .true.
!new_Z = 0.03d0

!set_uniform_initial_composition = .true.
!initial_h1 = 0.73d0
!initial_h2 = 0d0
!initial_he3 = 0d0
!initial_he4 = 0.267d0

change_v_flag = .true.
new_v_flag = .true.

 remove_center_by_temperature = 2d6


   !change_initial_v_flag = .true.
   !new_v_flag = .true.

relax_to_this_tau_factor = 1d-3!-1
dlogtau_factor = 0.1d0
relax_tau_factor = .true.

!imagesremove_initial_center_by_temperature = 2d6 !5d6


!relax_core = .true.
!relax_initial_core = .True.
!new_core_mass = 5
!dlg_core_mass_per_step = 1d-2
!relax_core_years_for_dt = 1d-6
!core_avg_rho = 0.00789!1e3
!core_avg_eps =  1122.5 !2126!1d-6
 

!change_RSP2_flag = .true.
!change_initial_RSP2_flag = .false.
!change_RSP2_flag_at_model_number = -111
!new_RSP2_flag = .true.
!create_RSP2_model = .false.

  !  set_initial_dt = .true.
  !  years_for_initial_dt = -1
  !  seconds_for_initial_dt = 1d-6!-1

set_initial_age = .true.
initial_age = 0

/ !end of star_job namelist


&controls

max_model_number = 2000

! kick when true and not restarting.
x_logical_ctrl(12) = .false.
 
   x_logical_ctrl(7) = .true. ! doing pulses
   x_integer_ctrl(7) = 0 ! 3 ! which period to check (<= 0 means don't check any)
   x_ctrl(7) = 15 ! expected period (in days) 
!   x_ctrl(8) = 1d-1 ! min_deltaR_for_periods (Rsun)
   x_ctrl(9) = 0.1 ! KE_growth_avg_abs_frac_new
   x_ctrl(10) = 0.1 ! min_period_div_target

! GYRE set starting velocities, kick!
   x_logical_ctrl(5) = .true. 
   x_ctrl(4) = 0d0 ! fraction_1st_overtone (order 2)
   x_ctrl(5) = 0d0 ! fraction_2nd_overtone (order 3)
   x_ctrl(6) = 0.1d0 ! initial vsurf (kms)

   !max_dq = 1d0!1d-3
   !max_center_cell_dq = 1d-4
   !max_surface_cell_dq = 1d0!1d-6 !1d-12
   !min_dq = 1d-7
 
!T_function1_weight = 20!110
!P_function_weight = 20
!log_tau_function_weight = 100

!use_fixed_Psurf_outer_BC = .true.
!fixed_Psurf = 0
!use_zero_Pgas_outer_BC = .true.
!Tsurf_factor = 0.5

!mesh_delta_coeff_factor_smooth_iters = 20

   convergence_ignore_equL_residuals = .true. ! .true.


   okay_to_remesh = .true.


!max_dq = 3d-2
!Pextra_factor =1.5!1.5

      atm_option = 'T_tau' !'T_tau'
      atm_T_tau_relation = 'Eddington'
      atm_T_tau_opacity = 'varying'

  ! use_fixed_Psurf_outer_BC = .true.
  ! fixed_Psurf = 0d0
use_zero_Pgas_outer_BC = .true.
RSP2_use_Stellingwerf_Lr = .true. ! works with tdc now.
RSP2_use_L_eqn_at_surface = .true.
RSP2_Lsurf_factor = 0.5d0

!use_dPrad_dm_form_of_T_gradient_eqn = .true.
!use_flux_limiting_with_dPrad_dm_form = .true.
!use_momentum_outer_BC = .true.
!use_compression_outer_BC = .true.

   tol_max_correction = 1d99

!   steps_before_use_velocity_time_centering = 0
!   use_P_d_1_div_rho_form_of_work_when_time_centering_velocity = .true.
   
!   include_P_in_velocity_time_centering = .true.
!   P_theta_for_velocity_time_centering = 0.5d0!

!   include_L_in_velocity_time_centering = .true.
!   L_theta_for_velocity_time_centering = 0.5d0

  ! set_rho_to_dm_div_dV = .true.
   
   use_Pvsc_art_visc = .true.
   Pvsc_cq = 4.0d0
   Pvsc_zsh = 0.1d0


   eps_nuc_factor = 0
   non_nuc_neu_factor = 0
   dxdt_nuc_factor = 0
   mix_factor = 0

   RSP2_assume_HSE = .true. ! default is true, for Hp face calculation

      photo_interval = 100!50


max_timestep = 1d7!1.2d3!2d3



! timesteps
!!  RSP_max_dt_times_min_dr_div_cs = 2d0
!   dt_div_min_dr_div_cs_limit = 2d0
!   dt_div_min_dr_div_cs_hard_limit = 4d0

!!  RSP_v_div_cs_threshold_for_dt_limit = 0.8d0
!   min_abs_u_div_cs_for_dt_div_min_dr_div_cs_limit = 0.8d0
   
!   min_q_for_dt_div_min_dr_div_cs_limit = 0.0d0
!   max_q_for_dt_div_min_dr_div_cs_limit = 1d0
!   min_k_for_dt_div_min_dr_div_cs_limit = 1 
!   min_abs_du_div_cs_for_dt_div_min_dr_div_cs_limit = 0.0d0


!   ! have used these values to do run to saturation, but may not be necessary
!   dt_div_min_dr_div_cs_limit = 0.5d0
!   min_q_for_dt_div_min_dr_div_cs_limit = 0.5d0
!   max_q_for_dt_div_min_dr_div_cs_limit = 1d0
!   min_k_for_dt_div_min_dr_div_cs_limit = 1 
!   min_abs_du_div_cs_for_dt_div_min_dr_div_cs_limit = 0.001d0


   ! in order for Riemann hydro to be opennanturned on, the following two conditions need to be met
   x_ctrl(11) = 1d-4! the integrated gamma1 must be smaller than this (min_gamma_sub_43_for_hydro)


! turn of fburning
!max_abar_for_burning = -1



   use_split_merge_amr = .false.! we want to switch before turning on hydro



   ! See Farag et al 2022
   !set_min_d_mix=.true.
   !min_d_mix=1d-2

      MLT_option = 'TDC'
      alpha_TDC_DAMP = 1d0
      alpha_TDC_DAMPR = 0d0!1d-2! 0d0 for mlt
      alpha_TDC_PtdVdt = 0d0!1d0!1d0!1d-2!1d0!0d0
      alpha_TDC_DampM = 0.25d0
      steps_before_use_TDC = 0

 !    mlt_Pturb_factor = 1d0

   !v_drag is set in run_star_extras
   !q_for_v_drag_full_off = 0.98d0
   !q_for_v_drag_full_on = 0.99d0


      !drag_coefficient = 0.8d0
      !min_q_for_drag = 0.98d0

!Pextra_factor = 2
/ ! end of controls namelist

&pgstar


   !pause = .true.
   !pause_interval = 100
   pgstar_interval = 5  ! 25

! window 1

   Grid1_win_flag = .true.
   Grid1_title = '6 M\d\(2281)\u Z=0.018 Cepheid RSP2'

   !Grid1_file_flag = .true.
   Grid1_file_dir = 'png1'
   Grid1_file_prefix = 'grid1'
   Grid1_file_interval = 10 ! output when mod(model_number,Grid1_file_interval)==0
   
   Profile_Panels1_xaxis_name = 'zone'
   Profile_Panels1_xaxis_reversed = .true.
   !Profile_Panels1_xmin = 50 ! -101D0
   !Profile_Panels1_xmax = 65 ! -101D0
   
! window 2
      
   Grid2_win_flag = .true.
   Grid2_title = '6 M\d\(2281)\u Z=0.03 Cepheid RSP2'
   
   History_Panels2_xaxis_name='day'
   History_Panels2_max_width = 40 ! only used if > 0.  causes xmin to move with xmax.

   Grid2_file_flag = .true.
   file_digits = 7
   Grid2_file_dir = 'png'
   Grid2_file_prefix = 'grid2'
   Grid2_file_interval = 5 ! output when mod(model_number,Grid2_file_interval)==0
   
   !Profile_Panels2_show_grid = .true.

   !Profile_Panels2_xaxis_name = 'logtau'
   !Profile_Panels2_xaxis_reversed = .true.
   !Profile_Panels2_xmin = -101d0
   !Profile_Panels2_xmax = -101D0

   Profile_Panels2_xaxis_name = 'logxm'
   Profile_Panels2_xaxis_reversed = .true.
   Profile_Panels2_xmin = -6
   Profile_Panels2_xmax = -0.1

   Profile_Panels2_xaxis_name = 'zone'
   Profile_Panels2_xaxis_reversed = .true.
   Profile_Panels2_xmin = -101
   Profile_Panels2_xmax = -101
   










!    History_Panels1_xaxis_name = 'star_age_day'!'model_number'
!    History_Panels1_max_width = 100 !5000! 10000


   ! History_Panels1_xaxis_name = 'yr_since_coll' ! need to change pulse condition for this.


         ! axis limits -- to override system default selections
        ! HR_logT_min = 3.5 !-101d0 ! only used if /= -101d0
        ! HR_logT_max = 4.5!-101d0 ! only used if /= -101d0
        ! HR_logL_min = 4.5!-101d0 ! only used if /= -101d0
         !HR_logL_max = 5.6!-101d0 ! only used if /= -101d0


! for some reason the logL_teff pgstar seems depracated? Needs fixed. 02/22/2025 -EbF
!logL_Teff_win_flag = .true.

!logL_Teff_logL_min = 4000
!logL_Teff_logL_max = 8000
!logL_Teff_Teff_min = 2500
!logL_Teff_Teff_max = 8000

/ ! end of pgstar namelist
