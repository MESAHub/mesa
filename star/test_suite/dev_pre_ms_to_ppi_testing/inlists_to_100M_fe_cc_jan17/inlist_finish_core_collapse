
&star_job
      show_log_description_at_start = .false.
   
      load_saved_model = .true.
      !saved_model_name = 'start_core_collapse.mod'
      saved_model_name = 'gamma1_limit.mod'

      save_model_when_terminate = .true.
      save_model_filename = 'final.mod'
      required_termination_code_string = 'fe_core_infall_limit'

      change_initial_u_flag = .true.
      change_initial_v_flag = .true.
      new_v_flag = .false.
      new_u_flag = .true.

      set_initial_age = .false.
      set_initial_model_number = .false.

      set_initial_dt = .true.
      seconds_for_initial_dt = 1d-2

      change_D_omega_flag = .true.
      new_D_omega_flag = .false.

      change_rotation_flag = .true.
      new_rotation_flag = .false.

      pgstar_flag = .true.

/ ! end of star_job namelist

&eos
      use_PC = .false.
/ ! end of eos namelist

&kap
      kap_file_prefix = 'a09'    ! 'gs98' 'a09'  'OP_a09' 'OP_gs98'
      kap_CO_prefix   = 'a09_co' ! 'gs98_co' 'a09_co'
      kap_lowT_prefix = 'lowT_fa05_a09p'
      use_Type2_opacities = .true.
/ ! end of kap namelist

&controls
   
      ! limit max_model_number as part of test_suite
      max_model_number = 10000

      fe_core_infall_limit = 3d7
      log_center_temp_limit = 1d99

! wind

! atmosphere
      Pextra_factor = 4 
      ! need this extra pressure to stabilize the atmosphere during core He burning
 
      atm_option = 'T_tau'
      atm_T_tau_relation = 'Eddington'
      atm_T_tau_opacity = 'fixed'

! rotation
      am_nu_visc_factor = 0
      am_D_mix_factor = 0.0333333333333333d00
      D_DSI_factor = 0
      D_SH_factor = 1
      D_SSI_factor = 1
      D_ES_factor = 1
      D_GSF_factor = 1
      D_ST_factor = 1

! mlt
      mixing_length_alpha = 1.5
      MLT_option = 'Henyey'

      use_Ledoux_criterion = .true.
      semiconvection_option = 'Langer_85 mixing; gradT = gradr'
      thermohaline_option = 'Kippenhahn'
      ! semiconvection and thermohaline are turned on in inlist_to_end_core_he_burn, off otherwise.
      alpha_semiconvection = 0
      thermohaline_coeff = 0

      mlt_make_surface_no_mixing = .true.

      okay_to_reduce_gradT_excess = .true.
      gradT_excess_f1 = 1d-4
      gradT_excess_f2 = 1d-2

! mixing
      D_omega_mixing_rate = 1d0
      D_omega_mixing_across_convection_boundary = .false.
      
! timesteps
      varcontrol_target = 1d-3
      
      never_skip_hard_limits = .true
      limit_for_rel_error_in_energy_conservation = 1d-4
      hard_limit_for_rel_error_in_energy_conservation = 1d-3

      min_xa_hard_limit = -1d-5
      min_xa_hard_limit_for_highT = -3d-5

      delta_lgTeff_limit =  0.01
      delta_lgL_limit = 0.1     
      delta_lgL_He_limit = 0.1

      delta_lgRho_cntr_limit = 0.03 ! 0.02 ! 0.005   ! default 0.05
      delta_lgRho_cntr_hard_limit = -1
      delta_lgRho_limit = 0.1          ! default 1.0
      
      delta_lgT_cntr_limit_only_after_near_zams = .true.
      delta_lgT_cntr_limit = 0.002  
      delta_lgT_cntr_hard_limit = 0.01

      delta_lgT_max_limit_only_after_near_zams = .true.
      delta_lgT_max_limit = 0.002     
      delta_lgT_max_hard_limit = 0.01

      dHe_div_He_limit = -1

      dX_nuc_drop_limit = 2d-2
      dX_nuc_drop_limit_at_high_T = -1  ! default = -1 = same as dX_nuc_drop_limit
      dX_nuc_drop_min_X_limit = 1d-3  ! 1.0d-3  default = 1.0d-4
      dX_nuc_drop_max_A_limit = 52   
      dX_nuc_drop_hard_limit = 1d99

      delta_lg_XH_cntr_limit = -1
      delta_lg_XHe_cntr_limit = -1
      delta_lg_XC_cntr_limit = -1
      delta_lg_XNe_cntr_limit = -1
      delta_lg_XO_cntr_limit = -1
      delta_lg_XSi_cntr_limit = -1

      delta_XHe_cntr_limit = -1 ! 0.01d0
      delta_XHe_cntr_hard_limit = -1 ! 0.02d0

      delta_XC_cntr_limit = -1 ! 0.01d0
      delta_XC_cntr_hard_limit = -1 ! 0.02d0

      delta_XNe_cntr_limit = -1 ! 0.01d0
      delta_XNe_cntr_hard_limit = -1 ! 0.02d0

      delta_XO_cntr_limit = -1 ! 0.01d0
      delta_XO_cntr_hard_limit = -1 ! 0.02d0

      delta_XSi_cntr_limit = -1 ! 0.01d0
      delta_XSi_cntr_hard_limit = -1 ! 0.02d0


      delta_Ye_highT_limit = 1d-3








! mesh

      okay_to_remesh = .true
      use_split_merge_amr = .true.
      split_merge_amr_log_zoning = .true.
      split_merge_amr_nz_baseline = 2000
      split_merge_amr_MaxLong = 2d0
      split_merge_amr_MaxShort = 2d0
      split_merge_amr_max_iters = 10

! solver
      use_gold2_tolerances = .false.
      use_gold_tolerances = .true.
      gold_tol_max_residual3 = 1d-4

      always_use_dedt_form_of_energy_eqn = .true.       




      
      !use_dPrad_dm_form_of_T_gradient_eqn = .true.
      !use_dedt_form_of_energy_eqn = .true.
      
      use_momentum_outer_BC = .true.
      
      !eps_nuc_factor = 0d0
      !dxdt_nuc_factor = 0d0

      !velocity_logT_lower_bound = 7 
      !max_dt_yrs_for_velocity_logT_lower_bound = 0.1

      solver_iters_timestep_limit = 20
      



      min_timestep_limit = 1d-12



      convergence_ignore_equL_residuals = .true. 
      make_gradr_sticky_in_solver_iters = .true.
      use_d_eos_dxa = .true.
      xa_scale = 1d-5
      iter_for_resid_tol2 = 10
      min_timestep_limit = 1d-12 ! (seconds)

      warn_rates_for_high_temp = .true.
      max_safe_logT_for_rates = 10.5d0

      when_to_stop_rtol = 1d-3
      when_to_stop_atol = 1d-3

      screening_mode = 'chugunov'

      sig_min_factor_for_high_Tcenter = 0.01
      Tcenter_min_for_sig_min_factor_full_on = 3.2d9
      Tcenter_max_for_sig_min_factor_full_off = 2.8d9

      op_split_burn = .true.
      op_split_burn_min_T = 1d9
      burn_steps_limit = 150
      burn_steps_hard_limit = 250
      op_split_burn_eps = 1d-5
      op_split_burn_odescal = 1d-5
      
! GYRE output controls
      !write_pulse_data_with_profile = .true.

! output



      center_avg_value_dq = 1d-2

      he_core_boundary_h1_fraction = 0.5
      c_core_boundary_he4_fraction = 0.5
      o_core_boundary_c12_fraction = 0.5
      si_core_boundary_o16_fraction = 0.5
      fe_core_boundary_si28_fraction = 0.5

      terminal_show_age_units = 'days'
      terminal_show_timestep_units = 'secs'
      terminal_show_log_dt = .false.
      terminal_show_log_age = .false.

      num_trace_history_values = 4
      trace_history_value_name(1) = 'non_fe_core_infall'
      trace_history_value_name(2) = 'fe_core_infall'
      trace_history_value_name(3) = 'rel_E_err'
      trace_history_value_name(4) = 'log_rel_run_E_err'

      photo_interval = 10
      !profile_interval = 1
      !history_interval = 1
      terminal_interval = 1

! FOR DEBUGGING

      !report_solver_progress = .true. ! set true to see info about solver iterations
      !report_ierr = .true. ! if true, produce terminal output when have some internal error
      !stop_for_bad_nums = .true.

      !solver_save_photo_call_number = 0
         ! Saves a photo when solver_call_number = solver_save_photo_call_number - 1
         ! e.g., useful for testing partials to set solver_call_number = solver_test_partials_call_number - 1

      !solver_test_partials_call_number = 187
      !solver_test_partials_k = 1322
      !solver_test_partials_iter_number = 2
      !solver_test_partials_dx_0 = 1d-5
      !solver_test_partials_var_name = '' ! 'all' or 'lnd', 'lnT', 'lnR', 'L', 'v', etc.    '' means code sets 
      !solver_test_partials_equ_name = '' ! 'all' or 'dlnE_dt', 'dlnd_dt', 'dlnR_dt', 'equL', etc   '' means code sets 
      !solver_test_partials_sink_name = 'si28' ! iso name to use for "sink" to keep sum = 1
      !solver_test_partials_show_dx_var_name = 'h1'

         ! equ name can also be one of these
            ! 'lnE', 'lnP', 'grad_ad' to test eos
            ! 'eps_nuc' to test net
            ! 'non_nuc_neu' to test neu
            ! 'gradT', 'mlt_vc' to test mlt
            ! 'opacity' to test kap

      !solver_test_partials_write_eos_call_info = .true.
      
      !solver_test_partials_k_low = -1
      !solver_test_partials_k_high = -1
      
      !solver_test_eos_partials = .true.
      !solver_test_kap_partials = .true.
      !solver_test_net_partials = .true.
      !solver_test_atm_partials = .true.

      !report_why_dt_limits = .true.
      !report_all_dt_limits = .true.
      !report_solver_dt_info = .true.
      
      !show_mesh_changes = .true.
      !mesh_dump_call_number = 5189
      !okay_to_remesh = .false.
      
      !energy_conservation_dump_model_number = -1
      
      !trace_evolve = .true.
      
      !use_DGESVX_in_bcyclic = .true.
      !use_equilibration_in_DGESVX = .true.
      !report_min_rcond_from_DGESXV = .true.


      ! solver debugging
      !solver_check_everything = .true.
      
      !solver_epsder_struct = 1d-6
      !solver_epsder_chem = 1d-6

      !fill_arrays_with_NaNs = .true.
      
      !report_solver_dt_info = .true.
      !report_dX_nuc_drop_dt_limits = .true.
      !report_bad_negative_xa = .true.
      
      !trace_k = 0

/ ! end of controls namelist

&pgstar



!pause = .true.
Profile_Panels3_xmin = 0 ! -101d0
Profile_Panels3_xmax = -101d0

Profile_Panels3_num_panels = 6

Profile_Panels3_other_yaxis_name(4) =  'v_div_cs'
Profile_Panels3_yaxis_name(4) = 'gamma1'
    Profile_Panels3_ymin(4) = 1.28d0
    Profile_Panels3_ymax(4) = -101d0

Profile_Panels3_other_yaxis_name(5) = 'vel_km_per_s'
Profile_Panels3_yaxis_name(5) = 'logRho' ! 'avQ'
 
Profile_Panels3_other_yaxis_name(6) = 'v_div_v_escape'
Profile_Panels3_yaxis_name(6) = 'logR_cm'

History_Panels1_yaxis_name(1) = 'star_mass'
History_Panels1_other_yaxis_name(2) = 'star_age_day'

Profile_Panels1_same_yaxis_range(3) = .false. ! .true.      << for comparison with 9967

TRho_Profile_xmin = -5 ! -2.0
TRho_Profile_ymin = 6 ! 7.5

Text_Summary1_name(1,1) = 'model_number'
Text_Summary1_name(1,2) = 'log_dt'
Text_Summary1_name(1,3) = 'Mass'
Text_Summary1_name(1,4) = 'center_ye'    
Text_Summary1_name(1,5) = 'H_rich'

Text_Summary1_name(2,1) = 'gamma1_min'  
Text_Summary1_name(2,2) = 'star_age_day'
Text_Summary1_name(2,3) = 'log_L'
Text_Summary1_name(2,4) = 'He_cntr'
Text_Summary1_name(2,5) = 'He_core'

Text_Summary1_name(3,1) = 'v_surf_div_escape_v'
Text_Summary1_name(3,2) = 'log_cntr_Rho'
Text_Summary1_name(3,3) = 'log_Teff'
Text_Summary1_name(3,4) = 'C_cntr'
Text_Summary1_name(3,5) = 'C_core'

Text_Summary1_name(4,1) = 'non_fe_core_infall'
Text_Summary1_name(4,2) = 'log_LH'
Text_Summary1_name(4,3) = 'lg_Lnuc'
Text_Summary1_name(4,4) = 'O_cntr'
Text_Summary1_name(4,5) = 'Fe_core'

Text_Summary1_name(5,1) = 'log_cntr_T'
Text_Summary1_name(5,2) = 'log_LHe'
Text_Summary1_name(5,3) = 'lg_Lneu'
Text_Summary1_name(5,4) = 'Ne_cntr'
Text_Summary1_name(5,5) = 'zones'

Text_Summary1_name(6,1) = 'log_max_T'
Text_Summary1_name(6,2) = 'log_LZ'
Text_Summary1_name(6,3) = 'lg_Lphoto'
Text_Summary1_name(6,4) = 'Si_cntr'
Text_Summary1_name(6,5) = 'retries'

/ ! end of pgstar namelist
