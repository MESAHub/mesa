! Enhanced MESA inlist for stellar evolution with synthetic photometry
! This inlist evolves a star from pre-main sequence through multiple evolutionary phases
! Uses the custom colors module to calculate synthetic magnitudes in multiple filters

! =============================================================================
! STAR_JOB NAMELIST - Controls model creation and global job settings
! =============================================================================
&star_job
      ! Model creation settings
      create_pre_main_sequence_model = .true.  ! Start from pre-MS rather than ZAMS
      
      ! Termination conditions
      ! required_termination_code_string = 'xa_central_lower_limit'  ! Stop when central H is depleted
      save_model_when_terminate = .true.
      save_model_filename = 'custom_colors_end.mod'
      required_termination_code_string = ''
      
      ! Graphics and plotting
      pgstar_flag = .false.  ! Enable real-time plotting (This is set to .false. for test hub -- .true. will enable a CMD and Light curves!!)
      
      ! Custom output files
      history_columns_file = 'custom_colors_history_columns.list'  ! Additional history columns
      
      ! Verbosity and debugging
      show_log_description_at_start = .true.  ! Print detailed info at start
      
      ! Pre-MS model settings
      pre_ms_relax_to_start_radiative_core = .false.  ! Don't force radiative core formation
/

! =============================================================================
! EOS NAMELIST - Equation of state settings (using defaults)
! =============================================================================
&eos
/

! =============================================================================
! KAP NAMELIST - Opacity settings
! =============================================================================
&kap
      Zbase = 0.014d0              ! Base metallicity (Z) for opacity tables
      kap_file_prefix = 'gs98'     ! Use Grevesse & Sauval 1998 opacity tables
/

! =============================================================================
! COLORS NAMELIST - Synthetic photometry settings
! Custom colors and this project inlist by Niall Miller
! =============================================================================
&colors
      ! Enable the colors module
      use_colors = .true.
      
      ! Filter system specification
      ! This points to a directory containing filter transmission curves
      ! The GAIA directory should contain files like:
      ! - Gbp_bright.dat, Gbp.dat, Gbp_faint.dat (Blue photometer filters)
      ! - G.dat (White light photometer)  
      ! - Grp.dat (Red photometer)
      ! - Grvs.dat (Radial Velocity Spectrometer)
      instrument = '/colors/data/filters/GAIA/GAIA'
      
      ! Vega spectrum for zero-point calibration
      ! This file should contain wavelength (Å) and flux (erg/s/cm²/Å) columns
      ! Used to define the zero-point of the magnitude system (Vega = 0.0 mag)
      vega_sed = '/colors/data/stellar_models/vega_flam.csv'
      
      ! Stellar atmosphere model directory
      ! Should contain:
      ! - lookup_table.csv: mapping file with columns for filename, Teff, log_g, metallicity
      ! - Individual SED files: wavelength vs surface flux for each stellar model
      ! - flux_cube.bin: pre-computed interpolation grid (if using linear/hermite interpolation)
      stellar_atm = '/colors/data/stellar_models/Kurucz2003all/'
      
      ! Physical parameters for synthetic photometry
      distance = 3.0857d16         ! Distance to star in cm (1 pc = 3.0857e16 m for absolute mags)
      
      ! Output options
      make_csv = .true.            ! Write detailed SED files showing filter convolution  -- This is also needed for plotting the SED.
                                   ! Creates files like: LOGS/SED/G_SED.csv, LOGS/SED/VEGA_G_SED.csv
/ ! end of colors namelist

! =============================================================================
! CONTROLS NAMELIST - Main stellar evolution parameters
! =============================================================================
&controls
      ! ==========================================================================
      ! BASIC STELLAR PARAMETERS
      ! ==========================================================================
      initial_mass = 2.5d0           ! Initial stellar mass in solar masses

      initial_z = 0.014d0          ! Initial metallicity (mass fraction of elements heavier than He)
                                   ! 0.014 ≈ solar metallicity
      
      ! ==========================================================================
      ! STOPPING CONDITIONS - Control when evolution ends
      ! ==========================================================================
      max_age = 2d9                ! Maximum age in years (2 Gyr)
      
      ! Stop when central hydrogen is depleted
      xa_central_lower_limit_species(1) = 'h1'  ! Watch central H1 mass fraction
      xa_central_lower_limit(1) = 1d-3          ! Stop when central H1 < 0.1%
      
      ! ==========================================================================
      ! OUTPUT CONTROL - Manage file writing frequency
      ! ==========================================================================
      profile_interval = 100       ! Write profile every 200 models (reduce for speed)
      history_interval = 1         ! Write history every model (needed for colors)
      terminal_interval = 30       ! Print to terminal every 20 models
      photo_interval = 100         ! Save restart files every 200 models
      max_model_number = 600      ! Maximum number of models before stopping
      
      ! ==========================================================================
      ! MASS LOSS - Stellar winds
      ! ==========================================================================
      ! RGB phase wind prescription (Reimers formula)
      cool_wind_RGB_scheme = 'Reimers'    ! Use Reimers (1975) wind formula
      Reimers_scaling_factor = 0.3d0      ! Scaling factor (typical range 0.1-0.5)
      
      ! AGB phase wind prescription (Blocker formula)  
      cool_wind_AGB_scheme = 'Blocker'    ! Use Blocker (1995) wind formula
      Blocker_scaling_factor = 0.05d0     ! Scaling factor for AGB winds
      
      ! ==========================================================================
      ! NUMERICAL CONTROLS - Balance speed vs accuracy
      ! ==========================================================================
      ! Timestep controls
      varcontrol_target = 1d-3             ! Relative error tolerance (larger = faster, less accurate)
      max_timestep = 1d6                   ! Maximum timestep in years (1 Myr)
      
/



! =============================================================================
! PGSTAR NAMELIST - Real-time plotting settings
! =============================================================================

&pgstar
  pgstar_interval = 10

  ! Standard HR Diagram
  HR_win_flag = .true.
  HR_logT_min = 3.2
  HR_logT_max = 4.3
  HR_logL_min = -1.0
  HR_logL_max = 4.0

  ! G band light curve
  History_Track2_win_flag = .true.
  History_Track2_xname = 'star_age'
  History_Track2_yname = 'G'
  History_Track2_title = 'G Light Curve'
  History_Track2_xaxis_label = 'Age (yr)'
  History_Track2_yaxis_label = 'G mag'

  ! Grp light curve
  History_Track3_win_flag = .true.
  History_Track3_xname = 'star_age'
  History_Track3_yname = 'Grp'
  History_Track3_title = 'Grp Light Curve'

  ! Grvs light curve
  History_Track4_win_flag = .true.
  History_Track4_xname = 'star_age'
  History_Track4_yname = 'Grvs'
  History_Track4_title = 'Grvs Light Curve'

  ! Flux_bol curve
  History_Track5_win_flag = .true.
  History_Track5_xname = 'star_age'
  History_Track5_yname = 'Flux_bol'
  History_Track5_title = 'Bolometric Flux'

/
