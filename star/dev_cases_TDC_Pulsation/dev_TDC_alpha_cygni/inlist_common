
&kap
 
kap_file_prefix = 'a09'    ! 'gs98' 'a09'  'OP_a09' 'OP_gs98'
kap_CO_prefix   = 'a09_co' ! 'gs98_co' 'a09_co'
Zbase = 0.0142d0
kap_lowT_prefix = 'lowT_fa05_a09p'
!AESOPUS_filename = 'AESOPUS_AGSS09.h5' ! used only if kap_lowT_prefix = 'AESOPUS'
use_Type2_opacities = .true.

!cubic_interpolation_in_X = .true.
!cubic_interpolation_in_Z = .true.

/

&eos


/ ! end of eos namelist

&star_job

   set_initial_cumulative_energy_error = .true.
   new_cumulative_energy_error = 0d0

   change_rotation_flag = .true.
   new_rotation_flag = .false.
   change_w_div_wc_flag = .true.
   new_w_div_wc_flag = .false.

   read_extra_star_job_inlist(1) = .true.
   extra_star_job_inlist_name(1) = 'inlist_extra'

   pgstar_flag = .true.
   save_pgstar_files_when_terminate = .true.

   num_special_rate_factors = 2
   reaction_for_special_factor(1) = 'r_c12_ag_o16'
   special_rate_factor(1) = 1
   filename_of_special_rate(1) = 'c12ag_deboer_sigma_0p0_2000_Tgrid.dat'

   reaction_for_special_factor(2) = 'r_he4_he4_he4_to_c12'
   special_rate_factor(2) = 1
   filename_of_special_rate(2) = 'r_he4_he4_he4_to_c12_cf88.txt'


/ !end of star_job namelist


&controls

   ! in principle this is the only thing that needs changing
   ! it is set in inlist_extra
   read_extra_controls_inlist(1) = .true.
   extra_controls_inlist_name(1)= 'inlist_extra'

! GYRE output controls
      !write_pulse_data_with_profile = .true.
      pulse_data_format = 'GYRE'
      
      x_logical_ctrl(37) = .true. ! if true, then run GYRE

      x_integer_ctrl(1) = 10 ! output GYRE info at this step interval
      x_logical_ctrl(1) = .false. ! save GYRE info whenever save profile

      x_integer_ctrl(2) = 3 ! max number of modes to output per call
      x_logical_ctrl(2) = .false. ! output eigenfunction files

      x_integer_ctrl(3) = 0 ! mode l (e.g. 0 for p modes, 1 for g modes)
         ! should match gyre.in mode l
      x_integer_ctrl(4) = 1 ! order
      x_ctrl(1) = 0.158d-05 ! freq ~ this (Hz)
      x_ctrl(2) = 0.33d+03 ! growth < this (days)


    okay_to_remove_mixing_singleton = .false.



    limit_for_rel_error_in_energy_conservation = 1d1
    hard_limit_for_rel_error_in_energy_conservation = 1d2



   ! adjustments to the newton solver
   solver_max_tries_before_reject = 30
   max_tries_for_retry = 30
   max_tries_after_5_retries = 40
   max_tries_after_10_retries = 40
   max_tries_after_20_retries = 40
   corr_coeff_limit = 1d-2


   use_gold_tolerances = .true.
   use_gold2_tolerances = .true.
   gold_iter_for_resid_tol2 = 10
   gold_iter_for_resid_tol3 = 10
   gold_tol_residual_norm3 = 1d-6
   gold_tol_max_residual3 = 1d-3
   gold_solver_iters_timestep_limit = 20
   solver_iters_timestep_limit = 50
   ignore_too_large_correction = .true.
   scale_max_correction = 0.1d0
   !corr_coeff_limit = 0.2d0
   ignore_min_corr_coeff_for_scale_max_correction = .true.
   ignore_species_in_max_correction = .true.


   mlt_make_surface_no_mixing = .false.
   !convergence_ignore_equL_residuals = .false., see other inlists 
   make_gradr_sticky_in_solver_iters = .false.
   xa_scale = 1d-5
   iter_for_resid_tol2 = 10



   ! during pulses very small cells near the surface can sometimes exceed
   ! the speed of light. This has no impact in the behaviour of the bulk
   ! of the star so we don't want to have a retry if that happens
   retry_for_v_above_clight = .false.

   
   relax_max_number_retries = 99999999!1000
   max_number_retries = 99999999 !500 ! RECOMMENDED 5000

   ! During hydro we can use es scattering opacity on the very outermost cell
   use_other_kap = .false.

   ! convection controls
      MLT_option = 'TDC'
      alpha_TDC_DAMP = 1d0
      alpha_TDC_DAMPR = 0d0
      alpha_TDC_PtdVdt = 0d0
      alpha_TDC_DAMPM = 0.25d0
      steps_before_use_TDC = 0

    use_ledoux_criterion = .true.
    alpha_semiconvection = 1d0
    thermohaline_coeff = 0d0
    num_cells_for_smooth_gradL_composition_term = 0
 
    energy_eqn_option = 'dedt'


    ! surface controls, probably uncessary
    scale_max_correction_for_negative_surf_lum = .true.
    max_frac_for_negative_surf_lum = 0.8


   ! overshoot controls
   ! we only include a bit of exponential overshooting to smooth things out

   overshoot_scheme(1) = 'none'
   overshoot_zone_type(1) = 'any'
   overshoot_zone_loc(1) = 'shell'
   overshoot_bdy_loc(1) = 'any'
   overshoot_f(1) = 0.001
   overshoot_f0(1) = 0.0005

   overshoot_scheme(2) = 'exponential'
   overshoot_zone_type(2) = 'any'
   overshoot_zone_loc(2) = 'core'
   overshoot_bdy_loc(2) = 'any'
   overshoot_f(2) = 0.01
   overshoot_f0(2) = 0.005

   overshoot_D_min = 1d-8
   

   ! timestep options
   varcontrol_target = 1d-3!5d-4
   max_timestep_factor = 1.2d0
   min_timestep_factor = 0.8d0
   dX_nuc_drop_limit = 5d-2
   dX_nuc_drop_limit_at_high_T = 1d-2 ! for center logT > 9.45
   delta_Ye_highT_limit = 1d-3
   dX_nuc_drop_max_A_limit = 52
   dX_nuc_drop_min_X_limit = 1d-4
   dX_nuc_drop_hard_limit = 1d99
   delta_lgTeff_limit = 1d0

   delta_lgL_hard_limit = -1!1d200
   delta_lgR_limit = 1d-1 !0.025d0
   delta_lgR_hard_limit = -1!0.05d0
   delta_lgR_limit_min_lgR = 3d0 ! 3d0 for >1000 Rsun
   delta_lgL_He_limit = -1d0
   lgL_nuc_burn_min = 4d0
   retry_hold = 0

   ! limit for changes in central abundances, RECOMMENDED 0.001d0 for all
   delta_XH_cntr_limit = 0.01d0
   delta_XHe_cntr_limit = 0.01d0
   delta_XC_cntr_limit = 0.01d0
   delta_XO_cntr_limit = 0.01d0

   ! extra controls for timestep
   delta_lg_star_mass_limit = 2d-3 ! RECOMMENDED 2d-3
   delta_lgRho_cntr_limit = 0.005d0 ! RECOMMENDED 0.0025d0
   delta_lgRho_cntr_hard_limit = 0.1d0 ! RECOMMENDED 0.005d0

   min_timestep_limit = 1d-20 ! (seconds)
   relax_hard_limits_after_retry = .false.

   ! mesh controls
   !max_dq = 1d-3 ! RECOMMENDED 1d-3

  ! rotational mixing coeffs
    !am_nu_ST_factor = 1.0
    !D_visc_factor = 0.0
    !am_nu_SH_factor = 0.0
    !D_ST_factor = 0.0
    !D_SH_factor = 0.0
    !D_GSF_factor = 1.0
    !D_ES_factor = 1.0
    !D_SSI_factor = 1.0
    !D_DSI_factor = 1.0
    !am_D_mix_factor = 0.0333333d0
    !am_gradmu_factor = 0.1d0
    !num_cells_for_smooth_gradL_composition_term = 2

    ! use implicit wind close to critical
    max_tries_for_implicit_wind = 10
    surf_avg_tau_min = 0
    surf_avg_tau = 10
    !max_mdot_redo_cnt = 200 ! this is set in inlist_hydro_on and inlist_hydro_off
    min_years_dt_for_redo_mdot = 0
    surf_omega_div_omega_crit_limit = 0.98d0
    surf_omega_div_omega_crit_tol = 0.02d0
    rotational_mdot_boost_fac = 1d10
    rotational_mdot_kh_fac = 1d10
    mdot_revise_factor = 1.1
    implicit_mdot_boost = 0.05
    ! this needs to be relaxed just to avoid a crash when hydro Riemann is turned on
    angular_momentum_error_retry = 1d99
    angular_momentum_error_warn = 1d-10

    ! Fixing the position of the Lagrangian region of the mesh helps
    ! convergence near the Eddington limit
    !max_logT_for_k_below_const_q = 100
    !max_q_for_k_below_const_q = 0.99
    !min_q_for_k_below_const_q = 0.99
    !max_logT_for_k_const_mass = 100
    !max_q_for_k_const_mass = 0.98
    !min_q_for_k_const_mass = 0.98


      photo_digits = 8
      photo_interval = 1000
      profile_interval = 200 
      history_interval = 1
      terminal_interval = 10
      max_num_profile_models = 1000000 ! 100 ! RECOMMENDED 10000


    num_trace_history_values = 2
    trace_history_value_name(1) = 'log_rel_run_E_err'
    trace_history_value_name(2) = 'rel_E_err'
    warn_when_large_rel_run_E_err = 1d-2
/ ! end of controls namelist

&pgstar

/
