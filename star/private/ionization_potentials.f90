! ***********************************************************************
!
!   Copyright (C) 2010  The MESA Team
!
!   MESA is free software; you can use it and/or modify
!   it under the combined terms and restrictions of the MESA MANIFESTO
!   and the GNU General Library Public License as published
!   by the Free Software Foundation; either version 2 of the License,
!   or (at your option) any later version.
!
!   You should have received a copy of the MESA MANIFESTO along with
!   this software; if not, it is available at the mesa website:
!   http://mesa.sourceforge.net/
!
!   MESA is distributed in the hope that it will be useful,
!   but WITHOUT ANY WARRANTY; without even the implied warranty of
!   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
!   See the GNU Library General Public License for more details.
!
!   You should have received a copy of the GNU Library General Public License
!   along with this software; if not, write to the Free Software
!   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA
!
! ***********************************************************************

      module ionization_potentials

      use const_def, only: dp
      use utils_lib, only: mesa_error

      implicit none


      logical :: ionization_tables_okay = .false.

      real(dp) :: ip(30,30) ! ionization_potentials

      contains


      subroutine set_ionization_potentials ! data from
         ! Allen, C.W., 1973, "Astrophysical Quantities", 3rd edition, pg 37-38.

         ! 1 h
         ip(1,1) = 13.598d0

         ! 2 he
         ip(2,1:2) = (/ &
            24.587d0, &
            54.416d0 /)

         ! 3 Li
         ip(3,1:3) = (/ &
            5.392d0, &
            75.638d0, &
            122.451d0 /)

         ! 4 Be
         ip(4,1:4) = (/ &
            9.322d0, &
            18.211d0, &
            153.893d0, &
            217.713d0 /)

         ! 5 B
         ip(5,1:5) = (/ &
            8.298d0, &
            21.155d0, &
            37.930d0, &
            259.366d0, &
            340.22d0 /)

         ! 6 C
         ip(6,1:6) = (/ &
            11.260d0, &
            21.383d0, &
            47.887d0, &
            64.492d0, &
            392.08d0, &
            489.98d0 /)

         ! 7 N
         ip(7,1:7) = (/ &
            14.543d0, &
            29.601d0, &
            47.448d0, &
            77.472d0, &
            97.89d0, &
            552.06d0, &
            667.03d0 /)

         ! 8 O
         ip(8,1:8) = (/ &
            13.618d0, &
            35.117d0, &
            54.934d0, &
            77.413d0, &
            113.90d0, &
            138.12d0, &
            739.32d0, &
            871.39d0 /)

         ! 9 F
         ip(9,1:9) = (/ &
            17.422d0, &
            34.970d0, &
            62.707d0, &
            87.138d0, &
            114.24d0, &
            157.16d0, &
            185.18d0, &
            953.89d0, &
            1103.1d0 /)

         ! 10 Ne
         ip(10,1:10) = (/ &
            21.564d0, &
            40.962d0, &
            63.45d0, &
            97.11d0, &
            126.21d0, &
            157.93d0, &
            207.26d0, &
            239.09d0, &
            1195.8d0, &
            1362.2d0 /)

         ! 11 Na
         ip(11,1:11) = (/ &
            5.139d0, &
            47.286d0, &
            71.64d0, &
            98.91d0, &
            138.40d0, &
            172.15d0, &
            208.48d0, &
            264.19d0, &
            299.9d0, &
            1465.1d0, &
            1648.7d0 /)

         ! 12 Mg
         ip(12,1:12) = (/ &
            7.646d0, &
            15.035d0, &
            80.143d0, &
            109.31d0, &
            141.27d0, &
            186.51d0, &
            224.95d0, &
            265.92d0, &
            328.0d0, &
            367.5d0, &
            1761.8d0, &
            1963.0d0 /)

         ! 13 Al
         ip(13,1:13) = (/ &
            5.986d0, &
            18.826d0, &
            28.448d0, &
            119.99d0, &
            153.75d0, &
            190.47d0, &
            241.44d0, &
            284.59d0, &
            330.2d0, &
            398.6d0, &
            442.0d0, &
            2086.0d0, &
            2304.0d0 /)

         ! 14 Si
         ip(14,1:14) = (/ &
            8.151d0, &
            16.345d0, &
            33.492d0, &
            45.141d0, &
            166.77d0, &
            205.08d0, &
            246.49d0, &
            303.16d0, &
            351.1d0, &
            401.4d0, &
            476.1d0, &
            523.0d0, &
            2438.0d0, &
            2304.0d0 /)

         ! 15 P
         ip(15,1:15) = (/ &
            10.486d0, &
            19.725d0, &
            30.18d0, &
            51.42d0, &
            65.02d0, &
            220.45d0, &
            263.28d0, &
            309.37d0, &
            371.7d0, &
            424.4d0, &
            479.5d0, &
            561.0d0, &
            612.0d0, &
            2817.0d0, &
            3070.0d0 /)

         ! 16 S
         ip(16,1:16) = (/ &
            10.360d0, &
            23.33d0, &
            34.83d0, &
            47.30d0, &
            72.68d0, &
            88.05d0, &
            280.01d0, &
            328.33d0, &
            400.4d0, &
            455.6d0, &
            529.3d0, &
            592.0d0, &
            657.0d0, &
            750.0d0, &
            3224.0d0, &
            3494.0d0 /)

         ! 17 Cl
         ip(17,1:17) = (/ &
            12.967d0, &
            23.81d0, &
            39.61d0, &
            53.46d0, &
            67.7d0, &
            97.03d0, &
            114.19d0, &
            348.37d0, &
            400.4d0, &
            455.6d0, &
            529.3d0, &
            592.0d0, &
            657.0d0, &
            750.0d0, &
            809.0d0, &
            3658.0d0, &
            3946.0d0 /)

         ! 18 Ar
         ip(18,1:18) = (/ &
            15.759d0, &
            27.629d0, &
            40.74d0, &
            59.81d0, &
            75.04d0, &
            91.01d0, &
            124.4d0, &
            143.45d0, &
            422.6d0, &
            478.9d0, &
            539.0d0, &
            618.0d0, &
            686.0d0, &
            756.0d0, &
            855.0d0, &
            918.0d0, &
            4121.0d0, &
            4426.0d0 /)

         ! 19 K
         ip(19,1:19) = (/ &
            4.341d0, &
            31.63d0, &
            45.72d0, &
            60.92d0, &
            82.66d0, &
            99.9d0, &
            117.7d0, &
            154.98d0, &
            175.8d0, &
            503.6d0, &
            564.4d0, &
            629.0d0, &
            714.0d0, &
            787.0d0, &
            862.0d0, &
            968.0d0, &
            1034.0d0, &
            4611.0d0, &
            4934.0d0 /)

         ! 20 Ca
         ip(20,1:20) = (/ &
            6.113d0, &
            11.871d0, &
            50.91d0, &
            67.15d0, &
            84.43d0, &
            108.78d0, &
            127.7d0, &
            147.4d0, &
            188.7d0, &
            211.3d0, &
            591.6d0, &
            657.0d0, &
            726.0d0, &
            817.0d0, &
            895.0d0, &
            974.0d0, &
            1087.0d0, &
            1157.0d0, &
            5129.0d0, &
            5470.0d0 /)

         ! 21 Sc
         ip(21,1:21) = (/ &
            6.54d0, &
            12.80d0, &
            24.76d0, &
            73.7d0, &
            91.7d0, &
            111.1d0, &
            138.0d0, &
            158.7d0, &
            180.2d0, &
            225.4d0, &
            249.8d0, &
            686.0d0, &
            756.0d0, &
            830.0d0, &
            927.0d0, &
            1009.0d0, &
            1094.0d0, &
            1213.0d0, &
            1288.0d0, &
            5675.0d0, &
            6034.0d0 /)

         ! 22 Ti
         ip(22,1:22) = (/ &
            6.82d0, &
            13.58d0, &
            27.49d0, &
            43.26d0, &
            99.4d0, &
            119.36d0, &
            140.8d0, &
            169.4d0, &
            193.0d0, &
            216.2d0, &
            265.3d0, &
            292.0d0, &
            788.0d0, &
            862.0d0, &
            941.0d0, &
            1044.0d0, &
            1131.0d0, &
            1221.0d0, &
            1346.0d0, &
            1425.0d0, &
            6249.0d0, &
            6626.0d0 /)

         ! 23 V
         ip(23,1:23) = (/ &
            6.74d0, &
            14.65d0, &
            29.31d0, &
            46.71d0, &
            65.23d0, &
            128.6d0, &
            150.3d0, &
            173.6d0, &
            205.8d0, &
            230.5d0, &
            255.1d0, &
            308.0d0, &
            336.0d0, &
            896.0d0, &
            975.0d0, &
            1060.0d0, &
            1168.0d0, &
            1260.0d0, &
            1355.0d0, &
            1486.0d0, &
            1569.0d0, &
            6851.0d0, &
            7246.0d0 /)

         ! 24 Cr
         ip(24,1:24) = (/ &
            6.766d0, &
            16.50d0, &
            30.96d0, &
            49.1d0, &
            70.2d0, &
            90.57d0, &
            161.1d0, &
            184.6d0, &
            209.3d0, &
            244.4d0, &
            270.7d0, &
            298.0d0, &
            355.0d0, &
            384.0d0, &
            1011.0d0, &
            1097.0d0, &
            1185.0d0, &
            1299.0d0, &
            1396.0d0, &
            1496.0d0, &
            1634.0d0, &
            1721.0d0, &
            7482.0d0, &
            7895.0d0 /)

         ! 25 Mn
         ip(25,1:25) = (/ &
            7.435d0, &
            15.640d0, &
            33.67d0, &
            51.4d0, &
            73.0d0, &
            97.0d0, &
            119.27d0, &
            196.47d0, &
            221.8d0, &
            248.3d0, &
            286.0d0, &
            314.0d0, &
            344.0d0, &
            404.0d0, &
            435.0d0, &
            1136.0d0, &
            1224.0d0, &
            1317.0d0, &
            1437.0d0, &
            1539.0d0, &
            1644.0d0, &
            1788.0d0, &
            1879.0d0, &
            8141.0d0, &
            8572.0d0 /)

         ! 26 Fe
         ip(26,1:26) = (/ &
            7.870d0, &
            16.16d0, &
            30.651d0, &
            54.8d0, &
            75.5d0, &
            100.0d0, &
            128.3d0, &
            151.12d0, &
            235.0d0, &
            262.1d0, &
            290.4d0, &
            331.0d0, &
            361.0d0, &
            392.0d0, &
            457.0d0, &
            489.0d0, &
            1266.0d0, &
            1358.0d0, &
            1456.0d0, &
            1582.0d0, &
            1689.0d0, &
            1799.0d0, &
            1950.0d0, &
            2045.0d0, &
            8828.0d0, &
            9278.0d0 /)

         ! 27 Co
         ip(27,1:27) = (/ &
            7.86d0, &
            17.06d0, &
            33.50d0, &
            51.3d0, &
            79.5d0, &
            103.0d0, &
            131.0d0, &
            160.0d0, &
            186.2d0, &
            176.2d0, &
            305.0d0, &
            336.0d0, &
            379.0d0, &
            411.0d0, &
            444.0d0, &
            512.0d0, &
            547.0d0, &
            1402.0d0, &
            1500.0d0, &
            1602.0d0, &
            1734.0d0, &
            1846.0d0, &
            1962.0d0, &
            2119.0d0, &
            2218.0d0, &
            9544.0d0, &
            10030.0d0 /)

         ! 28 Ni
         ip(28,1:28) = (/ &
            7.635d0, &
            18.168d0, &
            35.17d0, &
            54.9d0, &
            75.5d0, &
            108.0d0, &
            134.0d0, &
            164.0d0, &
            193.0d0, &
            224.6d0, &
            321.0d0, &
            352.0d0, &
            384.0d0, &
            430.0d0, &
            464.0d0, &
            499.0d0, &
            571.0d0, &
            607.0d0, &
            1546.0d0, &
            1648.0d0, &
            1756.0d0, &
            1894.0d0, &
            2010.0d0, &
            2131.0d0, &
            2295.0d0, &
            2398.0d0, &
            10280.0d0, &
            10790.0d0 /)

         ! 29 Cu
         ip(29,1:29) = (/ &
            7.726d0, &
            20.292d0, &
            36.83d0, &
            55.2d0, &
            79.9d0, &
            103.0d0, &
            139.0d0, &
            167.0d0, &
            199.0d0, &
            232.0d0, &
            266.0d0, &
            369.0d0, &
            401.0d0, &
            435.0d0, &
            484.0d0, &
            520.0d0, &
            557.0d0, &
            633.0d0, &
            671.0d0, &
            1698.0d0, &
            1804.0d0, &
            1919.0d0, &
            2060.0d0, &
            2182.0d0, &
            2310.0d0, &
            2478.0d0, &
            2560.0d0, &
            11050.0d0, &
            1d35 /)

         ! 30 Zn
         ip(30,1:30) = (/ &
            9.394d0, &
            17.964d0, &
            39.72d0, &
            59.4d0, &
            82.6d0, &
            108.0d0, &
            136.0d0, &
            175.0d0, &
            203.0d0, &
            238.0d0, &
            274.0d0, &
            311.0d0, &
            412.0d0, &
            454.0d0, &
            490.0d0, &
            542.0d0, &
            579.0d0, &
            619.0d0, &
            698.0d0, &
            738.0d0, &
            1856.0d0, &
            1970.0d0, &
            2088.0d0, &
            2234.0d0, &
            2363.0d0, &
            2495.0d0, &
            2660.0d0, &
            2730.0d0, &
            1d35, &
            1d35 /)

      end subroutine set_ionization_potentials


      end module ionization_potentials

