
&star_job
   read_extra_star_job_inlist1 = .true.
   extra_star_job_inlist1_name = 'inlist_which'

   show_log_description_at_start = .false.
   
   required_termination_code_string(1) = 'max_model_number' ! just for testing
      
   set_initial_age = .true.
   initial_age = 0
   
   set_initial_model_number = .true.
   initial_model_number = 0

   set_initial_dt = .true.
   seconds_for_initial_dt = 1d-4

   set_initial_tau_factor = .true.
   set_to_this_tau_factor = 1d0

   profile_starting_model = .true.
   
   set_initial_cumulative_energy_error = .true.
   new_cumulative_energy_error = 0d0

/ ! end of star_job namelist

&eos
   read_extra_eos_inlist1 = .true.
   extra_eos_inlist1_name = 'inlist_which'
/ ! end of eos namelist

&kap
   read_extra_kap_inlist1 = .true.
   extra_kap_inlist1_name = 'inlist_which'
/ ! end of kap namelist

&controls  
   read_extra_controls_inlist1 = .true.
   extra_controls_inlist1_name = 'inlist_which'

   max_model_number = 100000
   max_number_retries = 10000
      
! wind

! atmosphere
   atm_option = 'T_tau'
   atm_T_tau_relation = 'Eddington'
   atm_T_tau_opacity = 'fixed'
   Pextra_factor = 2

! rotation

! mlt

! mixing

! timesteps
   varcontrol_target = 1d-3 

! mesh
   okay_to_remesh = .false.

! solver
   always_use_dedt_form_of_energy_eqn = .true. ! no eps_grav

   eps_nuc_factor = 0
   non_nuc_neu_factor = 0
   dxdt_nuc_factor = 0
   mix_factor = 0

   set_rho_to_dm_div_dV = .false.
   
   Pvsc_cq = 4.0d0 ! viscosity parameter (viscosity pressure proportional to cq)
   Pvsc_zsh = 0.1d0 ! "turn-on" compression in units of sound speed.
   
! output
   terminal_show_age_units = 'days'
   terminal_show_timestep_units = 'secs'
   terminal_show_log_dt = .false.
   terminal_show_log_age = .false.

   num_trace_history_values = 1
   trace_history_value_name(1) = 'log_rel_run_E_err'
   trace_history_value_name(2) = 'rel_E_err'

   photo_interval = 4000
   profile_interval = 4000
   history_interval = 10
   terminal_interval = 4000

! RSP controls   
         
   ! Parameters of the convection model.
   ! Note that RSP_alfap, RSP_alfas, RSP_alfac, RSP_alfad and RSP_gammar
   ! are expressed in the units of standard values.
   ! Standard values are the ones for which static version of the Kuhfuss
   ! model reduces to standard MLT.
   ! See Table 1 in Smolec & Moskalik 2008
   ! http://adsabs.harvard.edu/abs/2008AcA....58..193S
   ! for standard values and the description of the parameters.
   
   RSP_alfa =      1.5d0         ! mixing length; alfa = 0 gives a purely radiative model.
   RSP_alfac =     1.0d0         ! convective flux; Lc ~ RSP_alfac
   RSP_alfas =     1.0d0         ! turbulent source; Lc ~ 1/ALFAS; PII ~ RSP_alfas
   RSP_alfad =     1.0d0         ! turbulent dissipation; damp ~ RSP_alfad
   RSP_alfap =     0.0d0         ! turbulent pressure; Pt ~ alfap     
   RSP_alfat =     0.0d0         ! turbulent flux; Lt ~ RSP_alfat; overshooting.
   RSP_alfam =     0.25d0        ! eddy viscosity; Chi & Eq ~ RSP_alfam
   RSP_gammar =    0.0d0         ! radiative losses; dampR ~ RSP_gammar          
            
   ! time weighting for end-of-step vs start-of-step values in equations.
   ! 1 corresponds to fully implicit scheme - stable, but can have large numerical damping.
   ! 0.5 corresponds to trapezoidal rule integration - gives least numerical damping.
   ! do not use values less than 0.5.  strongly recommend 0.5 for theta and thetat.
   ! don't mess with any of these unless you know what you are doing or like to watch the code crash.
   
   RSP_theta =      0.5d0        ! Pgas and Prad
   RSP_thetat =     0.5d0        ! Pturb
   RSP_thetae =     0.5d0        ! erad in terms using f_Edd
   RSP_thetaq =     1.0d0        ! Pvsc
   RSP_thetau =     1.0d0        ! Eq and Uq
   RSP_wtr =        0.6667d0     ! Lr
   RSP_wtc =        0.6667d0     ! Lc
   RSP_wtt =        0.6667d0     ! Lt
   RSP_gam =        1.0d0        ! Et src_snk

   ! controls for building the initial model
   RSP_nz = 150 ! total number of zones in initial model
   RSP_nz_outer = 40 ! number of zones in outer region of initial model
   RSP_T_anchor = 11d3 ! approx temperature at base of outer region
   RSP_T_inner = 2d6 ! T at inner boundary of initial model
   
   RSP_max_outer_dm_tries = 100 ! give up if fail to find outer dm in this many attempts
   RSP_max_inner_scale_tries = 100 ! give up if fail to find inner dm scale factor in this many attempts
   RSP_T_anchor_tolerance = 1d-8 
      ! allowed relative difference between T at base of outer region and T_anchor
      ! if fail trying to create initial model, try increasing this to 1d-6 or more
   RSP_T_inner_tolerance = 1d-8 
      ! allowed relative difference between T at inner boundary and T_inner
      ! if fail trying to create initial model, try increasing this to 1d-6 or more
   
   RSP_relax_initial_model = .true.
   RSP_relax_alfap_before_alfat = .true. ! else reverse the order         
   RSP_relax_max_tries = 1000   
   RSP_relax_dm_tolerance = 1d-6
   
   
   use_RSP_new_start_scheme = .false.
   !RSP_relax_max_abs_rel_hse_err = 1d-3

            
   ! Initial kick makes use of the scaled linear velocity eigenvector
   ! of a given mode or of the linear combination of the eigenvectors
   ! for the fundamental mode and first two radial overtones. 
   ! The surface velocity is set to RSP_kick_vsurf_km_per_sec and
   ! the mode content is set by RSP_fraction_1st_overtone and RSP_fraction_2nd_overtone
   RSP_kick_vsurf_km_per_sec = 0.1d0 ! can be negative
   RSP_fraction_1st_overtone = 0d0
   RSP_fraction_2nd_overtone = 0d0
   ! fraction from fundamental = 1d0 - (1st + 2nd)
   ! Note: This is important for models in which two or more modes are linearly unstable.
   ! Appropriate setting may help to arrive at the desired mode, since the final pulsation
   ! state may depend on initial conditions set by the three parameters above.
   ! Integration of the same model with different initial kicks is a way to study
   ! the nonlinear mode selection -
   ! for an example see Fig. 1 in Smolec & Moskalik 2010
   ! http://adsabs.harvard.edu/abs/2010A%26A...524A..40S .
   
   ! random initial velocity profile.  added to any kick from eigenvector.
   RSP_Avel = 0d0 ! kms. linear in mesh points from 0 at inner boundary to this at surface
   RSP_Arnd = 0d0 ! kms. random fluctuation at each mesh point.
   
   ! period controls
   RSP_target_steps_per_cycle = 600
   RSP_min_max_R_for_periods = -1 ! skip if < 0; Rsun units.
   RSP_min_PERIOD_div_PERIODLIN = 0.5d0
   RSP_mode_for_setting_PERIODLIN = 1 ! 0, 1, or 2 for fundamental, 1st, and 2nd overtones.
   RSP_default_PERIODLIN = 34560 ! 4 days

   ! when to stop
   RSP_max_num_periods = -1 ! ignore if < 0
   RSP_GREKM_avg_abs_frac_new = 0.1d0 ! fraction of new for updating avg at each cycle.
   RSP_GREKM_avg_abs_limit = -1 ! 0.01d0 ! ignore if < 0; else stop when GREKM_avg_abs < this limit.
   
   ! timestep limiting
   RSP_initial_dt_factor = 1d-2 ! set initial timestep to this times linear period/target_steps_per_cycle
      ! start with smaller timestep to give time for initial model to adjust
   !RSP_Uq_threshold_for_dt_limit = 100d0
   RSP_v_div_cs_threshold_for_dt_limit = 0.8d0
   RSP_max_dt_times_min_dr_div_cs = 2d0 ! limit dt by this
      ! i.e., make dt <= this times min sound crossing time dr/cs
      !      for cells with abs(Uq) > threshold
   RSP_max_dt = -1 ! seconds
   RSP_report_limit_dt = .false.

   ! artificial viscosity controls
   ! for the equations see: Appendix C in Stellingwerf 1975
   ! http://adsabs.harvard.edu/abs/1975ApJ...195..441S.
   ! In principle, for not too-non-adiabatic convective models artificial viscosity is not
   ! needed or should be very small. Hence a large cut-off parameter below (in purely
   ! radiative models the default value for cut-off was 0.01)
   RSP_cq = 4.0d0 ! viscosity parameter (viscosity pressure proportional to cq)
   RSP_zsh = 0.1d0 ! "turn-on" compression in units of sound speed.
      ! zsh > 0 delays onset of artificial viscosity
      ! can eliminate most/all interior dissipation while still providing for extreme cases.
      ! using this parameter the dependence of limiting amplitude on cq is very weak.
   ! for Tscharnuter & Winkler form of artificial viscosity
   RSP_Qvisc_linear = 0d0 
   RSP_Qvisc_quadratic = 0d0
      ! as described in section 4.2 of mesa3, 2015.
      ! RSP_Qvisc_linear is analogous to shock_spread_linear
      ! RSP_Qvisc_quadratic is analogous to shock_spread_quadratic
      ! if switch to this form, set RSP_cq = 0 to shut off the Neumann & Richtmyer form.
      ! note that this form also uses RSP_zsh to delay onset of artficial viscosity
   
   ! surface pressure.  provides outer boundary condition for momentum equation.
   RSP_use_Prad_for_Psurf = .false.
   RSP_use_atm_grey_with_kap_for_Psurf = .false.
   RSP_tau_surf_for_atm_grey_with_kap = 3d-3 ! for atm_grey_with_kap
   RSP_fixed_Psurf = .true.
   RSP_Psurf = 0d0 ! ignore if < 0.  else use as surface pressure.
   set_RSP_Psurf_to_multiple_of_initial_P1 = -1 ! ignore if < 0. 
      ! set RSP_Psurf to this times initial surface cell pressure
   RSP_surface_tau = 0.67d0 ! 0.001d0
   
   ! solver controls
   RSP_tol_max_corr = 1d-8
   RSP_tol_max_resid = 1d-6
   !RSP_max_iters_per_step = 100
   RSP_max_retries_per_step = 8
   RSP_report_undercorrections = .false.
   RSP_nz_div_IBOTOM = 30d0 ! set IBOTOM = RSP_nz/RSP_nz_div_IBOTOM
   RSP_min_tau_for_turbulent_flux = 2d2 ! optionally turn off turbulent flux near surface 
   
   ! output data for work integrals during a particular period
   RSP_work_period = -1
   RSP_work_filename = 'work.data'
   
   ! output data for 3d map.  format same as for gnuplot pm3d 
   RSP_write_map = .false.
   RSP_map_columns_filename = 'map_columns.list' ! subset of profile columns list
      ! items listed in your map columns must also appear in your profile columns
   RSP_map_filename = 'map.data'
   RSP_map_first_period = -1
   RSP_map_last_period = -1
   RSP_map_zone_interval = 2
   RSP_map_history_filename = 'map_history.data'
   
   ! rsp hooks
   !use_other_RSP_linear_analysis = .false.         
   !use_other_RSP_eddington_factor = .false.
   !use_other_RSP_build_model = .false.

   ! for special tests
   ! can set ALFA = 0 for pure radiative with no turbulence or convection.
   ! can set gamma_law_hydro > 0 and it will be used by rsp for eos.
   ! can set zero_gravity = .true.
   ! can set opacity to be constant times density.
   RSP_kap_density_factor = -1 ! ignore if < 0
      ! else set opacity to this times density
   
   ! rsp misc
   RSP_efl0 =      1.0d2        
   RSP_nmodes = 3 ! number of modes LINA will calculate for initial model
   RSP_trace_RSP_build_model = .false.
   !RSP_use_nlin_constants = .false.

   ! -------- following are not ready for general use --------
   
   ! initial model log_tau params
   !RSP_initial_model_outer_log_tau = -1d99 ! -2d0
   !RSP_initial_model_inner_log_tau = -1d99 ! 8d0
   
   !RSP_Qvisc_linear_static = 0d0
   
   ! rad hydro - not ready
   !RSP_use_diffusion_limit = .true.
   !RSP_use_T_form_of_erad_eqn = .true.
   !RSP_use_T_form_of_Fr_eqn = .true.
   !RSP_accel_eqn_use_Prad_instead_of_Fr_term = .true.
   !RSP_erad_eqn_dt_term_limit = 1d7 ! to avoid numeric issues when heat exchange time scale << dt
   !RSP_Fr_eqn_always_use_d_Prad_dm = .true. ! even for cases where f_Edd /= 1/3
   
   ! f_Edd - not ready
   !RSP_nz_div_number_of_core_rays_for_f_Edd = 5d0 ! adjust number of core rays to nz
   !RSP_max_tau_for_variable_f_Edd = 1d2 ! for tau > this, set f_Edd = 1/3
   !RSP_iterations_for_smoothing_f_Edd = 2
   
   ! parameters for radiative energy equation - not ready
   !RSP_kapE_factor = 1d0 ! absorption mean opacity is approximated by this factor times Rosseland
   !RSP_kapP_factor = 1d0 ! Planck mean opacity is approximated by this factor times Rosseland
            
   ! mesh adjustment - not ready
   ! note that rsp remeshing is off if okay_to_remesh is false
   !RSP_remesh_interval = 2 ! remesh when mod(model_number,this) == 0
   !RSP_max_periods_for_remeshing = 0 ! 0 means no remeshing; ignore this param if < 0
   !RSP_max_model_number_for_remeshing = -1 ! ignore this param if < 0
   !RSP_stop_remesh_after_set_velocities = .true.
   !RSP_do_global_remapping_corrections = .false.
   
   ! default mesh function weights
   !RSP_mesh_fcn_weight_lnd = 0d0
   !RSP_mesh_fcn_weight_lnT = 0d0
   !RSP_mesh_fcn_weight_lnP = 0d0
   !RSP_mesh_fcn_weight_lnE = 1d0
   !RSP_mesh_fcn_weight_lnm = 0d0
   !RSP_mesh_fcn_weight_lnkap = 0d0
   !RSP_mesh_fcn_weight_grada = 0d0
   !RSP_mesh_fcn_weight_lntau = 0d0
   !RSP_mesh_fcn_weight_avg_charge_H = 0d0
   !RSP_mesh_fcn_weight_avg_charge_He = 0d0
   !
   !RSP_remesh_fraction = 1d0 ! move mesh by this fraction of full remesh movement
   !RSP_limit_abs_max_dlnr = 1d-4 ! undercorrect if necessary to limit changes to this abs(dr)/r
   !RSP_no_remesh_inner_fraction_zones = 0.3330d0 ! remesh will keep these at fixed radial locations
   !RSP_no_remesh_outer_fraction_zones = 0.020d0 ! remesh will keep these at fixed radial locations
   !RSP_remesh_space_smoothing_alpha = 1.5d0
   !RSP_remesh_v_blend_fraction_for_KE = 1.0d0 ! < 0 means set v = v_div_r * r
   !
   !RSP_remesh_test_partials = .false.
   !trace_RSP_remesh = .false.

/ ! end of controls namelist

