      PROGRAMEVE
      IMPLICITREAL*8(A-H,O-Z)
      PARAMETER(NVARS=3)
      include '../obj/nfreq_and_mzone.inc'
      PARAMETER(NYDIM=(NVARS+2*NFREQ)*Mzon,MAXDER=4)
      Parameter(Is=5)
      PARAMETER(NZ=3000000)
      Parameter(Nstage=28,Natom=15)
      PARAMETER(KOMAX=80)
      LogicalLSYSTEM
      Parameter(LSystem=.FALSE.)
      Parameter(Pi=3.1415926535897932d+00,hPlanc=1.0545716280D-27,Cs=2.9979245800D+10,Boltzk=1.3806504000D-16,Avogar=6.0221417900D+2
     *3,AMbrun=1.6605387832D-24,AMelec=9.1093821500D-28,echarg=4.8032042700D-10,CG=6.6742800000D-08,CMS=1.9884000000D+33,RSol=6.9551
     *000000D+10,ULGR=1.4000000000D+01,UPURS=1.0000000000D+07,ULGPU=7.0000000000D+00,ULGEU=1.3000000000D+01,UPC=3.0856776000D+18,UTP
     *=1.0000000000D+05,URHO=1.0000000000D-06,CARAD=7.5657680191D-15,CSIGM=5.6704004778D-05,ERGEV=1.6021764864D-12,GRADeV=1.16045052
     *85D+04,RADC=7.5657680191D-02,CTOMP=4.0062048575D-01,CCAPS=2.6901213726D+01,CCAPZ=9.8964034725D+00)
      IntegerZn(Natom),ZnCo(Natom+1)
      DimensionAZ(Natom)
      Common/AZZn/AZ,Zn,ZnCo
      Common/NiAdap/tday,t_eve,XNifor(Mzon),AMeveNi,KNadap
      LOGICALFRST
      Parameter(Mfreq=130)
      Common/Kmzon/km,kmhap,Jac,FRST
      COMMON/STCOM1/t,H,HMIN,HMAX,EPS,N,METH,KFLAG,JSTART
      COMMON/YMAX/YMAX(NYDIM)
      COMMON/YSTIF/Y(NYDIM,MAXDER+1)
      COMMON/HNUSED/HUSED,NQUSED,NFUN,NJAC,NITER,NFAIL
      COMMON/HNT/HNT(7)
      PARAMETER(DELTA=1.d-05)
      PARAMETER(LICN=4*NZ,LIRN=2*NZ)
      LogicalNEEDBR
      COMMON/STJAC/THRMAT,HL,AJAC(LICN),IRN(LIRN),ICN(LICN),WJAC(NYDIM),FSAVE(NYDIM*2),IKEEP(5*NYDIM),IW(8*NYDIM),IDISP(11),NZMOD,NE
     *EDBR
      LOGICALCONV,CHNCND,SCAT,SEP
      COMMON/CUTOFF/FLOOR(NVARS+1),Wacc(NVARS+1),FitTau,TauTol,Rvis,CONV,CHNCND,SCAT,SEP
      LogicalLTHICK
      COMMON/THICK/LTHICK(Nfreq,Mzon)
      COMMON/CONVEC/UC(Mzon),YAINV(Mzon)
      COMMON/RAD/EDDJ(Mzon,Nfreq),EDDH(Mzon),HEDD(Nfreq),HEDRAD,CLIGHT,CKRAD,UFREQ,CFLUX,CCL,CLUM,CLUMF,CIMP,NTHICK(NFREQ),NTHNEW(NF
     *REQ),NCND,KRAD,NFRUS
      LOGICALEDTM
      COMMON/RADOLD/HEDOLD,HINEDD,EDTM
      Common/newedd/EddN(Mzon,Nfreq),HEdN(Nfreq),tfeau
      Common/oldedd/EddO(Mzon,Nfreq),HEdo(Nfreq),trlx
      Common/cnlast/Cnlast
      Common/Dhap/DHaphR(Mzon,Nfreq)
      COMMON/BAND/FREQ(NFREQ+1),FREQMN(NFREQ),WEIGHT(130),HAPPAL(NFREQ),HAPABSRON(NFREQ),HAPABS(NFREQ),DLOGNU(NFREQ)
      PARAMETER(NFRMIN=Nfreq/2)
      IntegerdLfrMax
      Common/observer/wH(Mfreq),cH(Mfreq),zerfr,Hcom(Mfreq),Hobs(Mfreq),freqob(Mfreq),dLfrMax
      Parameter(NP=15+15-1)
      Common/famu/fstatic(0:NP+1,Nfreq),fobs_corr(0:NP+1,Mfreq),fcom(0:NP+1,Mfreq),amustatic(0:NP+1)
      Common/rays/Pray(0:Np+1),fout(0:NP+1,Mfreq),abermu(0:NP+1),NmuNzon
      COMMON/LIM/Uplim,Haplim
      COMMON/AMM/DMIN,DM(Mzon),DMOUT,AMINI,AM(Mzon),AMOUT
      COMMON/Centr/RCE,Nzon
      Common/InEn/AMHT,EBurst,tBurst,tbeght
      COMMON/RADPUM/AMNI,XMNi,XNi,KmNick
      COMMON/RADGAM/FJgam(Mzon,2),toldg,tnewg
      COMMON/RADGlg/FJglog(Mzon,2)
      COMMON/CHEM/CHEM0(Mzon),RTphi(0:Mzon+1),EpsUq
      COMMON/REGIME/NREG(Mzon)
      doubleprecisionNRT
      COMMON/AQ/AQ,BQ,DRT,NRT
      COMMON/AZNUC/ACARB,ZCARB,ASI,ZSI,ANI,ZNI,QCSI,QSINI
      COMMON/QNRGYE/QNUC,RGASA,YELECT
      COMMON/CKN1/CK1,CK2,CFR,CRAP,CRAOLD
      LOGICALEVALJA,OLDJAC,BADSTE
      COMMON/EVAL/EVALJA,BADSTE,OLDJAC
      LogicalRadP
      COMMON/RadP/RadP
      COMMON/ARG/TP,PL,CHEM,LST,KENTR,JURS
      COMMON/RESULT/P,Egas,Sgas,ENG,CAPPA,PT,ET,ST,ENGT,CAPT,NZR
      COMMON/ABUND/XYZA,Yat(Natom)
      COMMON/AZ/AS,ZS,SCN
      COMMON/STR/PPL,EPL,SPL,ENGPL,CAPPL,CP,GAM,DA,DPE,DSE,DSP,BETgas
      COMMON/XELECT/XE,XET,XEPL,PE,Ycomp
      COMMON/URScap/Tpsqrt,Psicap,Scap,ScapT,ScapPl,ZMean,YZMean,ZMT,ZMPl,YZMT,YZMPl
      COMMON/BURNCC/CC,CCTP,CCPL,YDOT
      COMMON/ABarr/YABUN(Natom,Mzon)
      COMMON/UNSTL/UL,UPRESS,UE,UEPS,UCAP,UTIME,UV,UFLUX,UP
      COMMON/TAIL/KTAIL
      COMMON/UNINV/UPI,UEI
      COMMON/UNBSTL/UR,UM,UEPRI,ULGP,ULGE,ULGV,ULGTM,ULGEST,ULGFL,ULGCAP,ULGEPS
      Character*80Opafile
      real*4hptabab,hptababron,hptabsc,hpsavsc
      Common/Opsave/hpsavsc(Nfreq,14,14,Mzon/(Mzon/50)+1,6)
      Common/OpBand/TpTab(14),RhoTab(14),STab(6),Wavel(Nfreq),YATab(Natom),hptabab(Nfreq,14,14,Mzon/(Mzon/50)+1,2),hptababron(Nfreq,
     *14,14,Mzon/(Mzon/50)+1,2),hptabsc(Nfreq,14,14,Mzon/(Mzon/50)+1,2),Msta,Nrho,Ntp,im
      real*4hpbanab1(Nfreq,14,14,Mzon/(Mzon/50)+1),hpbanabron1(Nfreq,14,14,Mzon/(Mzon/50)+1),hpbansc1(Nfreq,14,14,Mzon/(Mzon/50)+1),
     *hpbanab2(Nfreq,14,14,Mzon/(Mzon/50)+1),hpbanabron2(Nfreq,14,14,Mzon/(Mzon/50)+1),hpbansc2(Nfreq,14,14,Mzon/(Mzon/50)+1)
      Equivalence(hptabab(1,1,1,1,1),hpbanab1(1,1,1,1)),(hptababron(1,1,1,1,1),hpbanabron1(1,1,1,1)),(hptabsc(1,1,1,1,1),hpbansc1(1,
     *1,1,1)),(hptabab(1,1,1,1,2),hpbanab2(1,1,1,1)),(hptababron(1,1,1,1,2),hpbanabron2(1,1,1,1)),(hptabsc(1,1,1,1,2),hpbansc2(1,1,1
     *,1))
      Common/tintrp/stmlog(6),tdlog,thaplog1,thaplog2,istold,Opafile
      Common/dumfreq/dumFreq(Nfreq+1),dumFreqmn(Nfreq),dumwavel(Nfreq)
      COMMON/CONUR/EIT,DST,BBRCNR(5)
      COMMON/BAL/EL(MAXDER+1),YENTOT(MAXDER+1),ETOT0,ELVOL,ELSURF,ELTOT,TPSURF,HOLDBL,ELOST,EKO,RADBEG
      common/NSTEP/NSTEP,NDebug,MAXER,IOUT,NOUT
      common/CREAD/TAUOLD,NSTMAX,MBATCH,MAXORD
      common/debug/LfrDebug,Nperturb,Kbad
      REAL*8TPMAX(MAXDER+1),TQ(4)
      COMMON/TAU/TAU(Mzon+1),FLUX(Mzon)
      common/tauubvri/tauU(Mzon),tauB(Mzon),tauV(Mzon),tauR(Mzon),tauI(Mzon)
      COMMON/PHOT/XJPH,DMPH,RPH,TPH,PLPH,VPH,CHEMPH,GRVPH,HP,JPH
      PARAMETER(NFUNC=6)
      REAL*4WORK(Mzon+2,NFREQ),WRK(Mzon,4)
      REAL*8WRKX(Mzon),WORKX(Mzon+2)
      COMMON/STEPD/WRKX,WORKX,TPHOT,TEFF,WORK,WRK,NPHOT,NZM
      PARAMETER(TMCRIT=1.D-6,TPNSE=5.D0,EPGROW=0.02D0)
      Common/RUTP/Ry(Mzon),Uy(Mzon),Ty(Mzon),Press(Mzon),Rho(Mzon)
      COMMON/TOO/TOO,KO,KNTO,TO(KOMAX),STO(KOMAX),NTO(KOMAX)
      Parameter(Lcurdm=1000)
      RealTcurv
      IntegerNFRUSED
      REAL*8Flsave
      Common/Curve/tcurv(8,Lcurdm),Depos(Lcurdm),Flsave(MFREQ+1,Lcurdm),NFRUSED(Lcurdm),Lsaved
      LOGICALBEGRUN
      Common/BEGR/BEGRUN
      CHARACTER*80Model,Sumprf,Sumcur,Depfile,Flxfile
      COMMON/Files/Model,Sumprf,Sumcur,Depfile,Flxfile
      CHARACTER*1app
      LogicalGivdtl
      Common/ABGrap/NSTA,NSTB,TcurA,TcurB,Givdtl
      REAL*8MBOL,MU,MB,MV,MR,MI,MBOL1
      COMMON/COLOR/MBOL,MU,MB,MV,MR,MI,UMB,BMV,MBOL1,LubvU,LubvB,LubvV,LubvR,LubvI,Lyman
      COMMON/DETAIL/QRTarr(Mzon),UUarr(Mzon),ArrLum(Mzon),Acc(Mzon)
      Common/XYZ/XA,YA,URM
      Parameter(CPSI=3.0176176020D-04,CPRESS=1.0035958999D-04,CRGAS=8.3144721451D-01,CAvD=6.0221419900D+17,CSaha=1.5271823083D+23,DL
     *OW=1.0000000000D+05,DUP=1.0000000000D+08,CWW=1.4476482730D-01,CLOW=1.6666666667D+00)
      Parameter(Zf=1.2000000000D+01,Tpzb=3.8875094954D+00,Tpzf=1.4818760698D+02)
      DIMENSIONPION(Nstage,Natom)
      DIMENSIONPsum(Nstage,Natom)
      DIMENSIONGWgL(Nstage,Natom)
      DIMENSIONGWcL(Nstage,Natom)
      Character*2Chames(Natom)
      DATAPION/1.577633D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,
     *0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D
     *+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,2.852
     *388D+00,6.312851D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0
     *.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+
     *00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,1.307132D+00,2.8287
     *14D+00,5.554381D+00,7.482121D+00,4.548804D+01,5.684351D+01,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.
     *000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+0
     *0,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,1.687295D+00,3.435514D+00,5.50355
     *3D+00,8.987690D+00,1.135652D+01,6.404817D+01,7.738233D+01,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.0
     *00000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00
     *,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,1.579837D+00,4.078520D+00,6.374819D+00,8.981191
     *D+00,1.321440D+01,1.602350D+01,8.577053D+01,1.010892D+02,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.00
     *0000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,
     *0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,2.501815D+00,4.765971D+00,7.426884D+00,1.127494D+01,1.466810D
     *+01,1.832468D+01,2.405614D+01,2.774637D+01,1.280093D+02,1.580766D+02,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000
     *000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0
     *.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,5.962395D-01,5.487771D+00,8.314629D+00,1.147686D+01,1.606064D+01,1.997135D+
     *01,2.419539D+01,3.065910D+01,3.480191D+01,1.700176D+02,1.913235D+02,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.0000
     *00D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.
     *000000D+00,0.000000D+00,0.000000D+00,8.870484D-01,1.740676D+00,9.295209D+00,1.268373D+01,1.639717D+01,2.164240D+01,2.611014D+0
     *1,3.085638D+01,3.806278D+01,4.263495D+01,2.044250D+02,2.277500D+02,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.00000
     *0D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.0
     *00000D+00,0.000000D+00,6.944136D-01,2.181647D+00,3.295680D+00,1.392541D+01,1.784773D+01,2.210658D+01,2.801328D+01,3.302642D+01
     *,3.831808D+01,4.625556D+01,5.128031D+01,2.420700D+02,2.673794D+02,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000
     *D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.00
     *0000D+00,9.457672D-01,1.891534D+00,3.887509D+00,5.233632D+00,1.935632D+01,2.381245D+01,2.860511D+01,3.517326D+01,4.074342D+01,
     *4.658049D+01,5.524905D+01,6.072638D+01,2.828830D+02,3.102000D+02,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D
     *+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,1.202
     *227D+00,2.715454D+00,4.061577D+00,5.488931D+00,8.436476D+00,1.021197D+01,3.260866D+01,3.810920D+01,4.398108D+01,5.188375D+01,5
     *.855634D+01,6.550744D+01,7.564977D+01,8.202065D+01,3.741061D+02,4.054614D+02,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+
     *00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,1.828870D+00,3.2028
     *44D+00,4.746243D+00,6.927890D+00,8.726588D+00,1.058331D+01,1.444761D+01,1.664086D+01,4.906385D+01,5.559719D+01,6.254829D+01,7.
     *177387D+01,7.957210D+01,8.764883D+01,9.925334D+01,1.065294D+02,4.782217D+02,5.136154D+02,0.000000D+00,0.000000D+00,0.000000D+0
     *0,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,7.091514D-01,1.377455D+00,5.94150
     *7D+00,7.809833D+00,9.805808D+00,1.262570D+01,1.485377D+01,1.712825D+01,2.190931D+01,2.452032D+01,6.868707D+01,7.626481D+01,8.4
     *31834D+01,9.487844D+01,1.038023D+02,1.130279D+02,1.261410D+02,1.342641D+02,5.951951D+02,6.347665D+02,0.000000D+00,0.000000D+00
     *,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,9.167560D-01,1.878537D+00,3.557013D+00,6.359269
     *D+00,8.703379D+00,1.150007D+01,1.450331D+01,1.752988D+01,2.725898D+01,3.040381D+01,3.368788D+01,3.838771D+01,4.189227D+01,4.54
     *8966D+01,5.303259D+01,5.686208D+01,1.467970D+02,1.575892D+02,1.689616D+02,1.835833D+02,1.960001D+02,2.087651D+02,2.262879D+02,
     *2.373121D+02,1.024446D+03,1.076666D+03,0.000000D+00,0.000000D+00,8.862941D-01,2.108423D+00,4.083626D+00,6.370874D+00,8.826387D
     *+00,1.253287D+01,1.543399D+01,1.879930D+01,2.239670D+01,2.606372D+01,3.725046D+01,4.084786D+01,4.456130D+01,4.989938D+01,5.384
     *491D+01,5.790648D+01,6.626173D+01,7.055540D+01,1.794057D+02,1.912423D+02,2.037751D+02,2.197893D+02,2.333666D+02,2.472920D+02,2
     *.663234D+02,2.783921D+02,1.193964D+03,1.250441D+03/
      DATAPsum/1.577633D+00,1.577633D+00,1.577633D+00,1.577633D+00,1.577633D+00,1.577633D+00,1.577633D+00,1.577633D+00,1.577633D+00,
     *1.577633D+00,1.577633D+00,1.577633D+00,1.577633D+00,1.577633D+00,1.577633D+00,1.577633D+00,1.577633D+00,1.577633D+00,1.577633D
     *+00,1.577633D+00,1.577633D+00,1.577633D+00,1.577633D+00,1.577633D+00,1.577633D+00,1.577633D+00,1.577633D+00,1.577633D+00,2.852
     *388D+00,9.165239D+00,9.165239D+00,9.165239D+00,9.165239D+00,9.165239D+00,9.165239D+00,9.165239D+00,9.165239D+00,9.165239D+00,9
     *.165239D+00,9.165239D+00,9.165239D+00,9.165239D+00,9.165239D+00,9.165239D+00,9.165239D+00,9.165239D+00,9.165239D+00,9.165239D+
     *00,9.165239D+00,9.165239D+00,9.165239D+00,9.165239D+00,9.165239D+00,9.165239D+00,9.165239D+00,9.165239D+00,1.307132D+00,4.1358
     *46D+00,9.690227D+00,1.717235D+01,6.266039D+01,1.195039D+02,1.195039D+02,1.195039D+02,1.195039D+02,1.195039D+02,1.195039D+02,1.
     *195039D+02,1.195039D+02,1.195039D+02,1.195039D+02,1.195039D+02,1.195039D+02,1.195039D+02,1.195039D+02,1.195039D+02,1.195039D+0
     *2,1.195039D+02,1.195039D+02,1.195039D+02,1.195039D+02,1.195039D+02,1.195039D+02,1.195039D+02,1.687295D+00,5.122809D+00,1.06263
     *6D+01,1.961405D+01,3.097057D+01,9.501874D+01,1.724011D+02,1.724011D+02,1.724011D+02,1.724011D+02,1.724011D+02,1.724011D+02,1.7
     *24011D+02,1.724011D+02,1.724011D+02,1.724011D+02,1.724011D+02,1.724011D+02,1.724011D+02,1.724011D+02,1.724011D+02,1.724011D+02
     *,1.724011D+02,1.724011D+02,1.724011D+02,1.724011D+02,1.724011D+02,1.724011D+02,1.579837D+00,5.658357D+00,1.203318D+01,2.101437
     *D+01,3.422877D+01,5.025227D+01,1.360228D+02,2.371120D+02,2.371120D+02,2.371120D+02,2.371120D+02,2.371120D+02,2.371120D+02,2.37
     *1120D+02,2.371120D+02,2.371120D+02,2.371120D+02,2.371120D+02,2.371120D+02,2.371120D+02,2.371120D+02,2.371120D+02,2.371120D+02,
     *2.371120D+02,2.371120D+02,2.371120D+02,2.371120D+02,2.371120D+02,2.501815D+00,7.267786D+00,1.469467D+01,2.596961D+01,4.063770D
     *+01,5.896238D+01,8.301852D+01,1.107649D+02,2.387742D+02,3.968508D+02,3.968508D+02,3.968508D+02,3.968508D+02,3.968508D+02,3.968
     *508D+02,3.968508D+02,3.968508D+02,3.968508D+02,3.968508D+02,3.968508D+02,3.968508D+02,3.968508D+02,3.968508D+02,3.968508D+02,3
     *.968508D+02,3.968508D+02,3.968508D+02,3.968508D+02,5.962395D-01,6.084010D+00,1.439864D+01,2.587550D+01,4.193613D+01,6.190749D+
     *01,8.610288D+01,1.167620D+02,1.515639D+02,3.215815D+02,5.129050D+02,5.129050D+02,5.129050D+02,5.129050D+02,5.129050D+02,5.1290
     *50D+02,5.129050D+02,5.129050D+02,5.129050D+02,5.129050D+02,5.129050D+02,5.129050D+02,5.129050D+02,5.129050D+02,5.129050D+02,5.
     *129050D+02,5.129050D+02,5.129050D+02,8.870484D-01,2.627724D+00,1.192293D+01,2.460666D+01,4.100383D+01,6.264623D+01,8.875637D+0
     *1,1.196127D+02,1.576755D+02,2.003105D+02,4.047355D+02,6.324855D+02,6.324855D+02,6.324855D+02,6.324855D+02,6.324855D+02,6.32485
     *5D+02,6.324855D+02,6.324855D+02,6.324855D+02,6.324855D+02,6.324855D+02,6.324855D+02,6.324855D+02,6.324855D+02,6.324855D+02,6.3
     *24855D+02,6.324855D+02,6.944136D-01,2.876061D+00,6.171740D+00,2.009715D+01,3.794488D+01,6.005146D+01,8.806474D+01,1.210912D+02
     *,1.594092D+02,2.056648D+02,2.569451D+02,4.990151D+02,7.663945D+02,7.663945D+02,7.663945D+02,7.663945D+02,7.663945D+02,7.663945
     *D+02,7.663945D+02,7.663945D+02,7.663945D+02,7.663945D+02,7.663945D+02,7.663945D+02,7.663945D+02,7.663945D+02,7.663945D+02,7.66
     *3945D+02,9.457672D-01,2.837302D+00,6.724811D+00,1.195844D+01,3.131476D+01,5.512721D+01,8.373231D+01,1.189056D+02,1.596490D+02,
     *2.062295D+02,2.614785D+02,3.222049D+02,6.050880D+02,9.152880D+02,9.152880D+02,9.152880D+02,9.152880D+02,9.152880D+02,9.152880D
     *+02,9.152880D+02,9.152880D+02,9.152880D+02,9.152880D+02,9.152880D+02,9.152880D+02,9.152880D+02,9.152880D+02,9.152880D+02,1.202
     *227D+00,3.917681D+00,7.979258D+00,1.346819D+01,2.190467D+01,3.211663D+01,6.472529D+01,1.028345D+02,1.468156D+02,1.986993D+02,2
     *.572557D+02,3.227631D+02,3.984129D+02,4.804335D+02,8.545396D+02,1.260001D+03,1.260001D+03,1.260001D+03,1.260001D+03,1.260001D+
     *03,1.260001D+03,1.260001D+03,1.260001D+03,1.260001D+03,1.260001D+03,1.260001D+03,1.260001D+03,1.260001D+03,1.828870D+00,5.0317
     *14D+00,9.777957D+00,1.670585D+01,2.543244D+01,3.601574D+01,5.046335D+01,6.710422D+01,1.161681D+02,1.717653D+02,2.343135D+02,3.
     *060874D+02,3.856595D+02,4.733083D+02,5.725617D+02,6.790910D+02,1.157313D+03,1.670928D+03,1.670928D+03,1.670928D+03,1.670928D+0
     *3,1.670928D+03,1.670928D+03,1.670928D+03,1.670928D+03,1.670928D+03,1.670928D+03,1.670928D+03,7.091514D-01,2.086606D+00,8.02811
     *3D+00,1.583795D+01,2.564375D+01,3.826946D+01,5.312322D+01,7.025147D+01,9.216078D+01,1.166811D+02,1.853682D+02,2.616330D+02,3.4
     *59513D+02,4.408298D+02,5.446321D+02,6.576600D+02,7.838009D+02,9.180651D+02,1.513260D+03,2.148027D+03,2.148027D+03,2.148027D+03
     *,2.148027D+03,2.148027D+03,2.148027D+03,2.148027D+03,2.148027D+03,2.148027D+03,9.167560D-01,2.795293D+00,6.352307D+00,1.271158
     *D+01,2.141496D+01,3.291502D+01,4.741833D+01,6.494821D+01,9.220720D+01,1.226110D+02,1.562989D+02,1.946866D+02,2.365789D+02,2.82
     *0685D+02,3.351011D+02,3.919632D+02,5.387602D+02,6.963494D+02,8.653110D+02,1.048894D+03,1.244894D+03,1.453659D+03,1.679947D+03,
     *1.917259D+03,2.941705D+03,4.018371D+03,4.018371D+03,4.018371D+03,8.862941D-01,2.994717D+00,7.078342D+00,1.344922D+01,2.227560D
     *+01,3.480847D+01,5.024246D+01,6.904176D+01,9.143846D+01,1.175022D+02,1.547526D+02,1.956005D+02,2.401618D+02,2.900612D+02,3.439
     *061D+02,4.018126D+02,4.680743D+02,5.386297D+02,7.180354D+02,9.092776D+02,1.113053D+03,1.332842D+03,1.566209D+03,1.813501D+03,2
     *.079824D+03,2.358216D+03,3.552181D+03,4.802622D+03/
      DATAGWgL/-6.931472D-01,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00
     *,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000
     *D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,6.93
     *1472D-01,-6.931472D-01,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00
     *,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000
     *D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,-4.054651D-01,-1.
     *791759D+00,6.931472D-01,-6.931472D-01,6.931472D-01,-6.931472D-01,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D
     *+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000
     *000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,8.109302D-01,-4.054651D-01,
     *-1.791759D+00,6.931472D-01,-6.931472D-01,6.931472D-01,-6.931472D-01,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.0000
     *00D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.
     *000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,-8.109302D-01,8.109302D-01,-4.054651D
     *-01,-1.791759D+00,6.931472D-01,-6.931472D-01,6.931472D-01,-6.931472D-01,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.
     *000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+0
     *0,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,1.791759D+00,4.054651D-01,-8.109302D-01,8.1093
     *02D-01,-4.054651D-01,-1.791759D+00,6.931472D-01,-6.931472D-01,6.931472D-01,-6.931472D-01,0.000000D+00,0.000000D+00,0.000000D+0
     *0,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.00000
     *0D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,-6.931472D-01,1.791759D+00,4.054651D-01,-8.109302D-01,8
     *.109302D-01,-4.054651D-01,-1.791759D+00,6.931472D-01,-6.931472D-01,6.931472D-01,-6.931472D-01,0.000000D+00,0.000000D+00,0.0000
     *00D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.
     *000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,6.931472D-01,-6.931472D-01,1.791759D+00,4.054651D-01,-8.109302D
     *-01,8.109302D-01,-4.054651D-01,-1.791759D+00,6.931472D-01,-6.931472D-01,6.931472D-01,-6.931472D-01,0.000000D+00,0.000000D+00,0
     *.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+
     *00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,-1.791759D+00,6.931472D-01,-6.931472D-01,1.791759D+00,4.054651D-01,-8.1
     *09302D-01,8.109302D-01,-4.054651D-01,-1.791759D+00,6.931472D-01,-6.931472D-01,6.931472D-01,-6.931472D-01,0.000000D+00,0.000000
     *D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.00
     *0000D+00,0.000000D+00,0.000000D+00,0.000000D+00,-4.054651D-01,-1.791759D+00,6.931472D-01,-6.931472D-01,1.791759D+00,4.054651D-
     *01,-8.109302D-01,8.109302D-01,-4.054651D-01,-1.791759D+00,6.931472D-01,-6.931472D-01,6.931472D-01,-6.931472D-01,0.000000D+00,0
     *.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+
     *00,0.000000D+00,0.000000D+00,0.000000D+00,-8.109302D-01,8.109302D-01,-4.054651D-01,-1.791759D+00,6.931472D-01,-6.931472D-01,1.
     *791759D+00,4.054651D-01,-8.109302D-01,8.109302D-01,-4.054651D-01,-1.791759D+00,6.931472D-01,-6.931472D-01,6.931472D-01,-6.9314
     *72D-01,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.
     *000000D+00,0.000000D+00,0.000000D+00,1.791759D+00,4.054651D-01,-8.109302D-01,8.109302D-01,-4.054651D-01,-1.791759D+00,6.931472
     *D-01,-6.931472D-01,1.791759D+00,4.054651D-01,-8.109302D-01,8.109302D-01,-4.054651D-01,-1.791759D+00,6.931472D-01,-6.931472D-01
     *,6.931472D-01,-6.931472D-01,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.00000
     *0D+00,0.000000D+00,0.000000D+00,6.931472D-01,-6.931472D-01,1.791759D+00,4.054651D-01,-8.109302D-01,8.109302D-01,-4.054651D-01,
     *-1.791759D+00,6.931472D-01,-6.931472D-01,1.791759D+00,4.054651D-01,-8.109302D-01,8.109302D-01,-4.054651D-01,-1.791759D+00,6.93
     *1472D-01,-6.931472D-01,6.931472D-01,-6.931472D-01,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+0
     *0,0.000000D+00,0.000000D+00,1.823216D-01,-1.823216D-01,-1.427116D+00,1.427116D+00,1.133287D-01,-2.876821D-01,-7.419373D-01,-2.
     *302585D+00,1.791759D+00,4.054651D-01,-8.109302D-01,8.109302D-01,-4.054651D-01,-1.791759D+00,6.931472D-01,-6.931472D-01,1.79175
     *9D+00,4.054651D-01,-8.109302D-01,8.109302D-01,-4.054651D-01,-1.791759D+00,6.931472D-01,-6.931472D-01,6.931472D-01,-6.931472D-0
     *1,0.000000D+00,0.000000D+00,-7.419373D-01,7.419373D-01,2.876821D-01,-1.133287D-01,-1.427116D+00,1.427116D+00,1.133287D-01,-2.8
     *76821D-01,-7.419373D-01,-2.302585D+00,1.791759D+00,4.054651D-01,-8.109302D-01,8.109302D-01,-4.054651D-01,-1.791759D+00,6.93147
     *2D-01,-6.931472D-01,1.791759D+00,4.054651D-01,-8.109302D-01,8.109302D-01,-4.054651D-01,-1.791759D+00,6.931472D-01,-6.931472D-0
     *1,6.931472D-01,-6.931472D-01/
      DATAGWcL/-6.931472D-01,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00
     *,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000
     *D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,6.93
     *1472D-01,-6.931472D-01,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00
     *,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000
     *D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,-9.162907D-01,-1.
     *791759D+00,6.931472D-01,-6.931472D-01,6.931472D-01,-6.931472D-01,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D
     *+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000
     *000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,-2.876821D-01,-9.162907D-01
     *,-1.791759D+00,6.931472D-01,-6.931472D-01,6.931472D-01,-6.931472D-01,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000
     *000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0
     *.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,2.876821D-01,-2.876821D-01,-9.162907
     *D-01,-1.791759D+00,6.931472D-01,-6.931472D-01,6.931472D-01,-6.931472D-01,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0
     *.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+
     *00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,1.791759D+00,9.162907D-01,2.876821D-01,-2.876
     *821D-01,-9.162907D-01,-1.791759D+00,6.931472D-01,-6.931472D-01,6.931472D-01,-6.931472D-01,0.000000D+00,0.000000D+00,0.000000D+
     *00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.0000
     *00D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,-6.931472D-01,1.791759D+00,9.162907D-01,2.876821D-01,-
     *2.876821D-01,-9.162907D-01,-1.791759D+00,6.931472D-01,-6.931472D-01,6.931472D-01,-6.931472D-01,0.000000D+00,0.000000D+00,0.000
     *000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0
     *.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,6.931472D-01,-6.931472D-01,1.791759D+00,9.162907D-01,2.876821D
     *-01,-2.876821D-01,-9.162907D-01,-1.791759D+00,6.931472D-01,-6.931472D-01,6.931472D-01,-6.931472D-01,0.000000D+00,0.000000D+00,
     *0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D
     *+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,-1.791759D+00,6.931472D-01,-6.931472D-01,1.791759D+00,9.162907D-01,2.8
     *76821D-01,-2.876821D-01,-9.162907D-01,-1.791759D+00,6.931472D-01,-6.931472D-01,6.931472D-01,-6.931472D-01,0.000000D+00,0.00000
     *0D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.0
     *00000D+00,0.000000D+00,0.000000D+00,0.000000D+00,-9.162907D-01,-1.791759D+00,6.931472D-01,-6.931472D-01,1.791759D+00,9.162907D
     *-01,2.876821D-01,-2.876821D-01,-9.162907D-01,-1.791759D+00,6.931472D-01,-6.931472D-01,6.931472D-01,-6.931472D-01,0.000000D+00,
     *0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D
     *+00,0.000000D+00,0.000000D+00,0.000000D+00,2.876821D-01,-2.876821D-01,-9.162907D-01,-1.791759D+00,6.931472D-01,-6.931472D-01,1
     *.791759D+00,9.162907D-01,2.876821D-01,-2.876821D-01,-9.162907D-01,-1.791759D+00,6.931472D-01,-6.931472D-01,6.931472D-01,-6.931
     *472D-01,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0
     *.000000D+00,0.000000D+00,0.000000D+00,1.791759D+00,9.162907D-01,2.876821D-01,-2.876821D-01,-9.162907D-01,-1.791759D+00,6.93147
     *2D-01,-6.931472D-01,1.791759D+00,9.162907D-01,2.876821D-01,-2.876821D-01,-9.162907D-01,-1.791759D+00,6.931472D-01,-6.931472D-0
     *1,6.931472D-01,-6.931472D-01,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.0000
     *00D+00,0.000000D+00,0.000000D+00,6.931472D-01,-6.931472D-01,1.791759D+00,9.162907D-01,2.876821D-01,-2.876821D-01,-9.162907D-01
     *,-1.791759D+00,6.931472D-01,-6.931472D-01,1.791759D+00,9.162907D-01,2.876821D-01,-2.876821D-01,-9.162907D-01,-1.791759D+00,6.9
     *31472D-01,-6.931472D-01,6.931472D-01,-6.931472D-01,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+00,0.000000D+
     *00,0.000000D+00,0.000000D+00,6.931472D-01,-6.931472D-01,1.823216D-01,-1.823216D-01,-5.596158D-01,-9.808293D-01,-1.504077D+00,-
     *2.302585D+00,1.791759D+00,9.162907D-01,2.876821D-01,-2.876821D-01,-9.162907D-01,-1.791759D+00,6.931472D-01,-6.931472D-01,1.791
     *759D+00,9.162907D-01,2.876821D-01,-2.876821D-01,-9.162907D-01,-1.791759D+00,6.931472D-01,-6.931472D-01,6.931472D-01,-6.931472D
     *-01,0.000000D+00,0.000000D+00,-1.504077D+00,1.504077D+00,9.808293D-01,5.596158D-01,1.823216D-01,-1.823216D-01,-5.596158D-01,-9
     *.808293D-01,-1.504077D+00,-2.302585D+00,1.791759D+00,9.162907D-01,2.876821D-01,-2.876821D-01,-9.162907D-01,-1.791759D+00,6.931
     *472D-01,-6.931472D-01,1.791759D+00,9.162907D-01,2.876821D-01,-2.876821D-01,-9.162907D-01,-1.791759D+00,6.931472D-01,-6.931472D
     *-01,6.931472D-01,-6.931472D-01/
      DataChames/'H ','He','C ','N ','O ','Ne','Na','Mg','Al','Si','S ','Ar','Ca','Fe','Ni'/
      Real*8WMOD(1800,22),AZinv(Mzon)
      IntegerNZONE,Nitind,IndAbun(Natom)
      DoubleprecisionRhomod(1800),Tpmod(1800),Pmod(1800),ammod(1800)
      DoubleprecisionXnimod(1800,2)
      dimensionXABUN(Natom+1,1800)
      LogicalWoomix
      IntegerNinm
      COMMON/nin/Ninm
      COMMON/ProfMod/WMOD,AZinv,Tpmod,Rhomod,Pmod,ammod,XNimod,XABUN,IndAbun,NZONE,Woomix
      Character*80NFILE,Dfile,Rfile,Mfile,Rhofile,ExtMod,CompMod,NiDist
      Parameter(NDIST=Mzon/3)
      Common/AMZ/AMZinn,AMZout,AMHein,AMHeout,BXY,XH,XHe,XZ,Averg
      COMMON/AM1/TMPR(Mzon+2),RHOEVE(Mzon+2),Radius(Mzon+2),VELOC(Mzon+2),EPSE1(Mzon+2),PRES1(Mzon+2),TAUZON(Mzon+2),ENERGY(Mzon+2)
      COMMON/DAN1/BM1,Rcen,BMK,RKON,PK,DENSCE,ANTROP,VSTRE,IPRINT,JZON
      COMMON/DAN2/EPS1,EPSD,EPSA,DELTD,DELTB,ITER1,ITER2
      REAL*8MIDDLE,DMID
      COMMON/DAN3/DM1,DM2,PLATO,CENTR,MIDDLE,DMID,Kadapt
      COMMON/TINT/TC,TS,AMISO,GAMT
      COMMON/DJI/JT,J1,JK
      COMMON/INTMP/TPF,TPROC,ALPHA
      COMMON/SAMPLE/sampleZ(Natom)
      COMMON/BEG/RBEG,AMBEG,ETOTO,POB
      COMMON/FAIL/IFAIL
      IntegerChange
      LogicalPrompt
      Character*3STATUS
      LogicalLexist
      Real*8PARMS(5),FACTDM
      real*8myrhom(1800)
      real*8totmass(Natom+1)
      DATAIndAbun/1,1,1,1,1,1,1,1,1,1,1,1,1,1,1/
      Open(unit=1,file='eve.1',status='old')
      READ(1,'(A)')
      read(1,*)Dfile,Rfile,Mfile,OpaFile,Rhofile,ExtMod,CompMod,NiDist
      close(1)
      Narg=Iargc()
      GOTO(09995,09994),Narg+1
      write(*,*)' Extra arguments.'
      Stop16
      GOTO09993
09995 CONTINUE
      GOTO09993
09994 CONTINUE
      write(*,*)' using model from argument'
      callGetArg(1,model)
      Mfile=model(1:length(model))//'.mod'
      Rhofile=model(1:length(model))//'.rho'
      NiDist=model(1:length(model))//'.xni'
      ExtMod='../../modmake/'//model(1:length(model))//'.hyd'
      CompMod='../../modmake/'//model(1:length(model))//'.abn'
      print*,Dfile,Rfile,Mfile,OpaFile,Rhofile,ExtMod,CompMod,NiDist
09993 CONTINUE
      Open(unit=7,file=Rfile)
      Open(unit=8,file=Dfile)
      Open(unit=10,file=Rhofile)
      Nc=8
      READ(Nc,'(A)')
      Read(Nc,*)ANTROP,DENSCE,DCold
      READ(Nc,'(A)')
      Read(Nc,*)RBEG,CRHO,RWIND,TpWIND,pWind
      READ(Nc,'(A)')
      Read(Nc,*)Rcen
      READ(Nc,'(A)')
      Read(Nc,*)TPROC
      Tproc=Tproc/UTp
      READ(Nc,'(A)')
      Read(Nc,*)VSTRE
      READ(Nc,'(A)')
      Read(Nc,*)ALPHA
      READ(Nc,'(A)')
      Read(Nc,*)BMK,BM1,AMeveNi
      READ(Nc,'(A)')
      Read(Nc,*)STEP
      READ(Nc,'(A)')
      Read(Nc,*)expfac,velofac,rhofac,xnifac
      READ(Nc,'(A)')
      Read(Nc,*)Kadapt
      READ(Nc,'(A)')
      Read(Nc,*)US
      READ(Nc,'(A)')
      Read(Nc,*)TC,TS
      READ(Nc,'(A)')
      Read(Nc,*)AMISO,GAMT
      READ(Nc,'(A)')
      Read(Nc,*)AS,ZS
      READ(Nc,'(A)')
      Read(Nc,*)XH,XHe,Depl
      XZ=(1.d0-XH-XHe)
      If(XZ.LT.0.d0.or.XZ.GT.1.d0)then
      write(*,*)' >>>>> EVEnew  Wrong XH, Xhe:  XZ=',XZ
      stop24
      endif
      READ(Nc,'(A)')
      Read(Nc,*)AVERG,IWOO
      READ(Nc,'(A)')
      Read(Nc,*)AMZinn,AMZout,AMHein,AMHeout,BXY
      READ(Nc,'(A)')
      Read(Nc,*)IPRINT
      READ(Nc,'(A)')
      Read(Nc,*)ITER1,ITER2
      READ(Nc,'(A)')
      Read(Nc,*)EPS1,EPSD,EPSA
      READ(Nc,'(A)')
      Read(Nc,*)ULGCAP,ULGEPS
      READ(Nc,'(A)')
      Read(Nc,*)H
      READ(Nc,'(A)')
      Read(Nc,*)DM1,DM2,PLATO,CENTR,DMID,MIDDLE
      WRITE(7,*)'DM2=',DM2
      EPS1=10.D0**EPS1
      EPSD=10.D0**EPSD
      EPSA=10.D0**EPSA
      i3=3
09992 IF(.NOT.(IndAbun(i3).EQ.0.AND.i3.LE.Natom))GOTO09991
      i3=i3+1
      GOTO09992
09991 CONTINUE
      Averg=AZ(i3)
      XA=XH
      YA=XHE/4.D0
      XYZA=XZ/AZ(i3)+XA+YA
      Hmass=(BMK-BM1)*(BXY*XH*(amzinn+amzout)/2.d0+XH*(1.d0-(amzinn+amzout)/2.d0))
      write(7,*)' Hmass=',Hmass
      SQ=0.D0
      EIT=1.D-5
      DST=1.D-4
      ULGTP=LOG10(UTP)
      ULGPL=LOG10(URHO)
      ULGTM=-(LOG10(4.D0*PI*CG)+ULGPL)/2.D0
      ULGP=ULGPL+2.D0*(ULGR-ULGTM)
      ULGV=(ULGR-ULGTM)
      UV=10.D0**ULGV
      ULGE=2.D0*(ULGR-ULGTM)
      UEPRI=4.D0*PI*10.D0**(ULGPL+3.D0*ULGR+ULGE-50.D0)
      UTIME=10.D0**ULGTM
      UR=10.D0**ULGR
      UP=10.D0**(ULGP-ULGPU)
      UPI=1.D0/UP
      UE=10.D0**(ULGE-ULGEU)
      UEI=1.D0/UE
      IURS=LOG10(10.D0**ULGR/RSOL)
      URS=10.D0**IURS
      CK1=8.D0/3.D0*CSIGM*10.D0**((3.D0*ULGTM)+4.D0*(ULGTP-ULGR)-2.D0*ULGPL-ULGCAP)
      CK2=10.D0**(ULGEPS+(3.D0*ULGTM)-2.D0*ULGR)
      CFR=1.5D0*10.D0**(ULGPL+ULGR+ULGCAP)
      CFR=2.D0/CFR
      CRAold=1.D0
      UM=4.D0*PI*10.D0**(ULGPL+3.D0*ULGR)/CMS
      URM=UR/RSOL
      Woomix=Kadapt.LT.0
      Kadapt=ABS(Kadapt)
      RADP=.true.
      chem=1.d0
      if(Woomix)then
      	
      write(*,*)' Natom=',Natom,' in %B_mix_sampleZ'
      DO09989ii=1,Natom
      If(IndAbun(ii).GT.0)Then
      SampleZ(ii)=Wmod(IWOO,IndAbun(ii))
      else
      SampleZ(ii)=0.d0
      endif
      write(*,*)' eve IWOO sample ii',IWOO,ii,sampleZ(ii)
09989 CONTINUE
      DO09986Nmod=1,NZONE
      Ammod(Nmod)=Wmod(Nmod,1)
09986 CONTINUE
      endif
      sum=0.d0
      DO09983i=1,Natom
      sum=sum+sampleZ(i)
09983 CONTINUE
      DO09980i=1,Natom
      YATab(i)=sampleZ(i)/(AZ(i)*sum)
      sampleZ(i)=YATab(i)*AZ(i)
09980 CONTINUE
      PARMS(1)=BMK
      PARMS(2)=Rbeg
      PARMS(3)=Alpha
      PARMS(4)=BM1
      PARMS(5)=BXY
      IF(RWIND.GT.0.)THEN
      write(*,*)' MODEL WITH WIND',RBEG,CRHO,RWIND
      J1=MZON/2+2
      JT=J1
      ELSE
      If(BM1.GT.0.)then
      J1=Mzon+2
      JT=Mzon+2
      else
      J1=Mzon+1
      JT=Mzon+1
      endif
      ENDIF
      If(Kadapt.EQ.4.OR.Kadapt.EQ.6)Then
      Open(unit=11,file=ExtMod,form='unformatted',status='old')
      read(11)NZone,Nitind
      write(*,*)' in %BM_modelfile: NZone,Nitind=',NZone,Nitind
      DO09977k=1,NZone
      read(11)(WMOD(k,i),i=1,Nitind)
09977 CONTINUE
      read(11)IndAbun
      write(*,*)' IndAbun:',IndAbun
      If(.NOT.Woomix)read(11)(XNimod(k,1),k=1,NZone)
      Ninm=0
      DO09974Nmod=1,NZONE
      XYZe=2.d0*Wmod(Nmod,IndAbun(1))
      write(*,'(a,1p,e10.3,a,i5)')'  XH=',XYZE/2.d0,' nm=',nmod
      write(*,'(a,1p,e10.3)')'  XFe=',Wmod(Nmod,IndAbun(14))
      DO09971ii=2,Natom
      If(IndAbun(ii).GT.0)Then
      XYZe=XYZe+Wmod(Nmod,IndAbun(ii))*(1.d0+Real(Zn(ii)))/AZ(ii)
      YAT(ii)=Wmod(Nmod,IndAbun(ii))/AZ(ii)
      Else
      YAT(ii)=0.d0
      Endif
09971 CONTINUE
      write(*,'(a,1p,e12.3)')'  XYZe=',XYZe
      Ammod(Nmod)=Wmod(Nmod,1)
      If(Ammod(Nmod).GT.BM1.AND.Ninm.EQ.0)Ninm=max(1,Nmod-2)
      write(*,'(a,1p,e12.3,0p,2(a,i6))')' ammod=',ammod(Nmod),' nm=',nmod,'   Ninm=',Ninm
      Rhomod(Nmod)=Wmod(Nmod,2)*XYZe/Urho
      myrhom(Nmod)=Wmod(Nmod,2)/Urho
      write(*,'(a,1p,e12.3)')' Rhomod[1/cm^3]=',Rhomod(Nmod)
      Tpmod(Nmod)=Wmod(Nmod,3)
      If(Kadapt.EQ.4)Then
      Pmod(Nmod)=Wmod(Nmod,4)/10.d0**UlgP
      write(*,'(a,1p,e12.3)')' Pmod=',Pmod(Nmod)
      ElseIf(Kadapt.EQ.6)Then
      Tp=Tpmod(Nmod)/UTP
      Pl=Wmod(Nmod,2)/Urho
      callursos
      Pmod(Nmod)=P*UpUrs/10.d0**UlgP
      Endif
      If(Nmod.GT.Ninm.AND.Ninm.NE.0.AND.Pmod(Nmod).GE.Pmod(max(Nmod-1,1)))write(*,*)'nonmonotonic P in foreign zone=',Nmod
      If(Nmod.GT.Ninm.AND.Ninm.NE.0.AND.Wmod(Nmod,2).GE.Wmod(max(Nmod-1,1),2))write(*,*)'nonmonotonic Rho in foreign zone=',Nmod
09974 CONTINUE
      close(11)
      Endif
      TC=TC/UTP
      TS=TS/UTP
      Rcen=Rcen*RSOL/UR
      IPARM=0
09968 CONTINUE
      IPARM=IPARM+1
      dcold=densce
      anold=antrop
      if(iparm.GT.1)then
      antrop=antrop*facant
      endif
      If(Lsystem)Then
      write(*,*)'Continue ? If yes then'
      write(*,*)'input Change^=0, Mass(1), Radius(2), Alpha(3)...'
      write(*,*)'Change>0 for sequence, Change<0 for ONE model'
      read(5,*)Change
      Else
      Change=-1
      Endif
      If(change.EQ.0)stop
      Prompt=Change.LT.0
      BMK=PARMS(1)
      RBEG=PARMS(2)
      Alpha=PARMS(3)
      BM1=PARMS(4)
      BXY=PARMS(5)
      RKON=RBEG*RSOL/UR
      BM1=BM1/UM
      BMK=BMK/UM
      MIDDLE=MIDDLE/UM
      EKO=0.d0
      EKOpr=EKO/UEPRI
      open(unit=20,file='test.sn2')
      write(20,*)' Rbeg ',Rbeg,' Mzon ',Mzon,' Rce ',Rce,' Rsol ',Rsol,' UR ',UR,'Densce =',Densce
      open(unit=23,file=ExtMod(1:length(ExtMod)),status='old')
      read(23,*)timeStart,Nzon,BM1,Rcen,rhoCen
      DO09965j=1,Nzon
      read(23,*)idum,dum,Radius(j),RHOeve(j),TMPR(j),VELOC(j),	dum,dum
09965 CONTINUE
      close(23,status='keep')
      open(unit=23,file=CompMod(1:length(CompMod)),status='old')
      DO09962j=1,Nzon
      read(23,*)idum,dum,dum,dum,(YABUN(k,j),k=1,Natom),XNifor(j)
      restfac=1.d0
      XNifor(j)=max(xnifac*XNifor(j),1.d-6)
      	DO09959k=1,Natom
      if(k.NE.Natom-1)then
      YABUN(k,j)=restfac*YABUN(k,j)/AZ(k)
      else
      YABUN(k,j)=(restfac*YABUN(k,j)+XNifor(j))/AZ(k)
      endif
      	
09959 CONTINUE
      sum=0.d0
      DO09956i=1,Natom
      sum=sum+Yabun(i,j)*AZ(i)
09956 CONTINUE
      DO09953i=1,Natom
      Yabun(i,j)=Yabun(i,j)/sum
09953 CONTINUE
      Xnifor(j)=Xnifor(j)/sum
09962 CONTINUE
      close(23,status='keep')
      veloc(1)=veloc(2)*Radius(1)/Radius(2)
      DO09950K=Nzon,1,-1
      Radius(K)=expfac*Radius(K)/UR
      if(k.EQ.nzon.or.k.EQ.1)write(*,*)' radius (1e14cm): ',k,Radius(k)
      TMPR(K)=max(TMPR(K)/UTp/expfac,2.d3/UTp)
      VELOC(K)=velofac*VELOC(K)/(UR/Utime)
      RHOeve(K)=rhofac*RHOeve(K)/Urho/expfac**3
09950 CONTINUE
      rhoCen=rhofac*rhoCen/Urho/expfac**3
      BM1=BM1/UM
      Rcen=Rcen/UR
      AMini=BM1
      DO09947K=1,Nzon
      if(K.NE.1)then
      DM(K)=(Radius(K)**3-Radius(K-1)**3)*RHOeve(K)/3.d0
      else
      DM(K)=(Radius(K)**3-Rcen**3)*rhoCen/3.d0
      endif
      if(DM(K).LT.0.d0)then
      write(*,'(1x,a,i4,1p,5(1x,a,e10.3))')' K =',K,' AM(K)*UM =',AM(K)*UM,' DM(K)*UM =',DM(K)*UM,' Radius(K)*UR =',Radius(K)*UR,' R
     *adius(K-1)*UR =',Radius(max(K-1,1))*UR,' RHOeve(K)=',RHOeve(K)
      pause
      endif
      if(K.NE.1)then
      AM(K)=AM(K-1)+DM(K)
      else
      AM(K)=DM(K)+AMini
      endif
      write(20,'(1x,a,i4,1p,4(1x,a,e10.3))')' K =',K,' AM(K)*UM =',AM(K)*UM,' DM(K)*UM =',DM(K)*UM,' Radius(K)*UR =',Radius(K)*UR,' 
     *RHOeve(K)=',RHOeve(K)
09947 CONTINUE
      DMOUT=0.5d0*DM(MZON)
      AMOUT=AM(MZON)+DMOUT
      IF(Ifail.NE.0)STOP5
      facden=densce/dcold
      facant=antrop/anold
      If(Lsystem)Then
      open(10)
      Write(10,*)PARMS,ANTROP,DENSCE
      CLOSE(10)
      Endif
      Write(7,*)' ANTROP          DENSCE          DENSCE-old'
      Write(7,*)ANTROP,DENSCE,DCold
      Write(7,*)'  Rbeg'
      Write(7,*)Rbeg
      IF(.NOT.Prompt)PARMS(Change)=PARMS(Change)*Step
      IF(.NOT.(Prompt.OR.STEP.LE.0.))GOTO09968
      If(Lsystem)Then
      write(*,*)' Enter positive factor to change mass zones'
      read(5,*,end=09998,iostat=irc)factdm
      else
      factdm=-1.d-03
      endif
      Write(20,*)'factdm =',factdm
      close(20)
      if(factdm.GT.0.d0)then
      endif
      IF(RWIND.GT.0.)THEN
      Nzon=Mzon
      TAUW=0.D0
      Basis=(RWIND/RBEG)**(1.D0/(DBLE(MZON-J1+1)))
      K=J1-1
      Radius(K+1)=Radius(K)*BASIS
      RhoW=CRHO/(Radius(K+1)*UR)**2*(Radius(K+1)*UR*1.d-15)**(2.d0-pWind)
      Rhoedg=dM(K-1)*(3.D0*URHO)/(Radius(K)**3-Radius(K-1)**3)
      Tpedge=TMPR(K)
      Redge=Radius(K)
      Rhocor=Rhoedg-RhoW
      Write(7,*)' RhoW=',RhoW,'    Rhocor=',Rhocor
      if(Rhocor.LT.0.d0)then
      Write(*,*)' RhoW=',RhoW,'    Rhocor=',Rhocor
      Write(*,*)' enter 1 if you wish rho>RhoW'
      read(*,*)keywind
      endif
      if(keywind.NE.1)then
      DO09944K=J1-1,Mzon
      Radius(K+1)=Radius(K)*BASIS
      RhoW=CRHO/(Radius(K+1)*UR)**2*(Radius(K+1)*UR*1.d-15)**(2.d0-pWind)
      RhoW=RhoW+Rhocor*(Redge/Radius(K+1))**6
      TMPR(K+1)=Tpwind/UTp+(Tpedge-Tpwind/UTp)*(Redge/Radius(K+1))**2
      TAUW=TAUW+0.2*(1.+XH)*RhoW*(Radius(K+1)-Radius(K))*UR
      DM(K)=RhoW/(3.D0*URHO)*(Radius(K+1)**3-Radius(K)**3)
      AM(K)=AM(K-1)+DM(K)
      If(Kadapt.EQ.4.OR.Kadapt.EQ.5.OR.Kadapt.EQ.6)Then
      DO09941ii=1,Natom
      YABUN(ii,k)=YATab(ii)
09941 CONTINUE
      Else
      DO09938ii=1,Natom
      YABUN(ii,k)=YABUN(ii,J1-2)
09938 CONTINUE
      Endif
      VELOC(K+1)=0.D0
09944 CONTINUE
      else
      K1=K-1
      RhoW=CRHO/(Radius(K1+1)*UR)**2*(Radius(K1+1)*UR*1.d-15)**(2.d0-pWind)
09935 IF(.NOT.(3.D0*URHO*DM(K1)/(Radius(K1+1)**3-Radius(K1)**3).LT.RhoW.AND.K1.GT.2))GOTO09934
      DM(K1)=RhoW/(3.D0*URHO)*(Radius(K1+1)**3-Radius(K1)**3)
      write(*,*)' dm corrected K1=',K1
      K1=K1-1
      RhoW=CRHO/(Radius(K1+1)*UR)**2*(Radius(K1+1)*UR*1.d-15)**(2.d0-pWind)
      GOTO09935
09934 CONTINUE
      DO09932K=K1+1,J1-2
      write(*,*)' am corrected K=',K
      AM(K)=AM(K-1)+DM(K)
09932 CONTINUE
      DO09929K=J1-1,Mzon
      Radius(K+1)=Radius(K)*BASIS
      RhoW=CRHO/(Radius(K+1)*UR)**2*(Radius(K+1)*UR*1.d-15)**(2.d0-pWind)
      RhoW=RhoW/(1.d0+(Radius(K+1)*UR/4.5d15)**12)
      TAUW=TAUW+0.2*(1.+XH)*RhoW*(Radius(K+1)-Radius(K))*UR
      DM(K)=RhoW/(3.D0*URHO)*(Radius(K+1)**3-Radius(K)**3)
      AM(K)=AM(K-1)+DM(K)
      If(Kadapt.EQ.4.OR.Kadapt.EQ.5.OR.Kadapt.EQ.6)Then
      DO09926ii=1,Natom
      YABUN(ii,k)=YATab(ii)
09926 CONTINUE
      Else
      DO09923ii=1,Natom
      YABUN(ii,k)=YABUN(ii,J1-2)
09923 CONTINUE
      Endif
      VELOC(K+1)=0.D0
09929 CONTINUE
      endif
      write(*,*)' TAUWIND=',TAUW
      keywind=0
      Write(*,*)' enter km>0 if you wish a shell in zone km'
      read(*,*)keywind
      If(keywind.GT.0)then
      Write(*,*)' enter tau_Tompson shell '
      read(*,*)taushell
      rhoshell=taushell/(0.2*(1.+XH)*(Radius(keywind+1)-Radius(keywind))*UR)
      DM(keywind)=rhoshell/(3.D0*URHO)*(Radius(keywind+1)**3-Radius(keywind)**3)
      dok=keywind,Mzon
      AM(K)=AM(K-1)+DM(K)
      enddo
      write(*,'(a,1p,2e12.3)')' taushell rhoshell=',taushell,rhoshell
      write(*,*)' dm corrected Kshell=',keywind
      TAUW=TAUW+0.2*(1.+XH)*rhoshell*(Radius(keywind+1)-Radius(keywind))*UR
      write(*,*)' TAUWIND corrected=',TAUW
      endif
      DMOUT=DM(MZON)
      AMOUT=AM(MZON)+DMOUT
      K=J1-1
09920 IF(.NOT.(TMPR(K).LT.TPWIND/UTP.AND.K.GT.1))GOTO09919
      TMPR(K)=TPWIND/UTP
      K=K-1
      GOTO09920
09919 CONTINUE
      ENDIF
      DO09917K=1,Mzon
      Ry(K)=Radius(K)
      Y(K,1)=Ry(K)
      Uy(K)=VELOC(K)
      Y(K+Mzon,1)=Uy(K)
      If(Rwind.GT.0.d0)then
      If(Tmpr(K+1).LT.Tpwind/UTp)then
      Ty(K)=Tpwind/UTp
      else
      Ty(K)=TMPR(K+1)
      endif
      else
      Ty(K)=TMPR(K)
      endif
      Y(K+2*Mzon,1)=TY(K)
09917 CONTINUE
      rho(1)=3.D0*DM(1)/(Ry(1)**3-Rcen**3)
      DO09914I=2,Mzon
      rho(I)=3.D0*DM(I)/(Ry(I)**3-Ry(I-1)**3)
09914 CONTINUE
      I=Mzon
      TAU(I)=0.D0
09911 IF(.NOT.((I.GT.1.AND.TAU(I).LT.0.64D0).or.I.GT.Mzon-2))GOTO09910
      DO09908ii=1,Natom
      Yat(ii)=YABUN(ii,I)
09908 CONTINUE
      PL=rho(I)
      TP=Ty(I)
      WRITE(7,'(a,i4,2(a,1p,e12.4))')' I=',I,'  pl=',PL,'   Tp=',Tp
      CALLURSOSZ
      WRITE(7,*)' After Ursos'
      kmhap=I
      callopacit
      TAU(I-1)=TAU(I)+(Ry(I)-Ry(I-1))*cappa*pl*(UR*URHO)
      WRITE(7,'(2(a,1p,e12.4))')' TAU=',TAU(I-1),'  Ry(I)=',Ry(I)
      I=I-1
      GOTO09911
09910 CONTINUE
      JPH=I
      RPH=Ry(I+1)+(Ry(I)-Ry(I+1))/(TAU(I)-TAU(I+1))*(0.64D0-TAU(I+1))
      VPH=Uy(I+1)+(Uy(I)-Uy(I+1))/(TAU(I)-TAU(I+1))*(0.64D0-TAU(I+1))
      wtph=(0.64D0-0.5D0*(TAU(I+1)+TAU(I+2)))/(0.5D0*(TAU(I)-TAU(I+2)))
      TPH4=(Ty(I+2)**4+(Ty(I+1)**4-Ty(I+2)**4)/(0.5D0*(TAU(I)-TAU(I+2)))*(0.64D0-0.5D0*(TAU(I+1)+TAU(I+2))))
      TPH4=Ty(I+1)**4*wtph+Ty(I+2)**4*(1.d0-wtph)
      WRITE(7,'(2(a,1p,e12.4))')' 1 wtph=',wtph,' Tph4=',Tph4
      if(0.5D0*(TAU(I+1)+TAU(I+2)).GT.0.64D0)wtph=0.d0
      TPH4=Ty(I+1)**4*wtph+Ty(I+2)**4*(1.d0-wtph)
      WRITE(7,'(2(a,1p,e12.4))')' 2 wtph=',wtph,' Tph4=',Tph4
      TPH=Tph4**.25D0
      WRITE(7,'(2(A,1P,G12.5))')' ALPHA=',ALPHA,'   TEFF=',TPH*UTP
      If(.NOT.Woomix.AND.(Kadapt.EQ.4.OR.Kadapt.EQ.6))then
      i=1
      write(*,*)' Nickel ammod=',ammod(Nzone),'   BMK*UM=',BMK*UM
      DO09905km=1,Mzon
09902 IF(.NOT.(am(km)/(amout+(ammod(Nzone)-BMK*UM)/UM).GT.ammod(i)/ammod(NZONE).AND.i.LT.NZONE))GOTO09901
      i=i+1
      GOTO09902
09901 CONTINUE
      XNifor(km)=XNimod(i,1)
09905 CONTINUE
      endif
      Open(Unit=18,file=NiDist,form='unformatted')
      write(18)(XNifor(k),k=1,MZon)
      Close(18)
      t=timeStart*expfac/Utime
      write(*,*)' start time ',t*Utime
      NSTEP=0
      ELOST=0.D0
      RADBEG=Radius(Nzon)*UR/Rsol
      DO09899Km=1,Mzon
      NREG(Km)=3
      YAINV(Km)=12.D0
      UC(Km)=0.D0
09899 CONTINUE
      KTAIL=120
      RCE=RCEN
      KRAD=0
      NQ=0
      Lunit=9
      NFILE=Mfile
      callStradIO('we',LUNIT,NFILE)
      Lunit=10
      WRITE(10,'(2A,15(11X,A2))')'     zone    mass       lg r        lg(Tp)       lg(rho)','    u          Ni ',Chames
      WRITE(10,'(i6,1p,g15.4)')Nzon,t*Utime
      DO09896j=1,Natom
      totmass(j)=0.d0
09896 CONTINUE
      DO09893Km=1,NZON
      WRITE(10,' (i4,1p,22e13.4)' )Km,AM(Km)*UM,log10(max(Ry(Km),1.d-100))+UlgR,log10(max(Ty(Km),1.d-100))+UlgTp,log10(max(rho(Km),1
     *.d-100))+UlgPl,Uy(Km)*UR/Utime,log10(max(XNIfor(km),1.d-15)),(LOG10(max(Yabun(j,km)*AZ(j),1.d-15)),j=1,Natom)
      DO09890j=1,Natom
      totmass(j)=totmass(j)+Yabun(j,km)*AZ(j)*dm(Km)*UM
09890 CONTINUE
      totmass(Natom+1)=totmass(Natom+1)+XNIfor(km)*dm(Km)*UM
09893 CONTINUE
      WRITE(10,'(''#'',65x,16f13.5)')totmass(Natom+1),(totmass(j),j=1,Natom)
      close(9)
      stop
203   write(7,*)' error in open file ',Lunit
09998 Close(6)
      Close(8)
      Close(9)
      Close(10)
      END
      BLOCKDATAEVEDAT
      IMPLICITREAL*8(A-H,O-Z)
      REAL*8M
      PARAMETER(NVARS=3)
      include '../obj/nfreq_and_mzone.inc'
      PARAMETER(NYDIM=(NVARS+2*NFREQ)*Mzon,MAXDER=4)
      Parameter(Is=5)
      PARAMETER(NZ=3000000)
      Parameter(Nstage=28,Natom=15)
      PARAMETER(KOMAX=80)
      LogicalLSYSTEM
      Parameter(LSystem=.FALSE.)
      COMMON/AMM/DM(Mzon+2),M(Mzon+2)
      COMMON/DAN1/BM1,Rcen,BMK,RKON,PK,DENSCE,ANTROP,VSTRE,IPRINT,JZON
      COMMON/DAN2/EPS1,EPSD,EPSA,DELTD,DELTB,ITER1,ITER2
      REAL*8MIDDLE,DMID
      COMMON/DAN3/DM1,DM2,PLATO,CENTR,MIDDLE,DMID,Kadapt
      COMMON/DANN/AN
      COMMON/BTIME/TIME,DTN,DT0,DTK1,DTK2,DTOLD,DTMAX,TOO
      COMMON/UNSTL/UL,UPRESS,UE,UEPS,UCAP,UTIME,UV,UFLUX,UP
      COMMON/UNBSTL/UR,UM,UEPRI,ULGP,ULGE,ULGV,ULGTM,ULGEST,ULGFL,ULGCAP,ULGEPS
      COMMON/DJI/JT,J1,JK
      COMMON/CKN/CK1,CK2,CKL,CKS,ARAD,SGM
      COMMON/INFP/NUMST,NDPR,NPRIN,NCONTR
      DATAUCAP/1.D0/,UEPS/1.D0/
      DATAAN/3.D0/,JZON/Mzon/,BM1/1.6D0/,Rcen/0.D0/,BMK/1.D0/,RKON/1.D0/,PK/0.D0/
      DATADENSCE/162.55D0/,ANTROP/0.15654D0/
      DATAVSTRE/0.5D0/,IPRINT/2/
      DATAEPS1/1.D-06/,EPSD/1.D-06/,EPSA/1.D-06/
      DATAITER1/20/,ITER2/20/,DELTD/0.001D0/,DELTB/0.001D0/
      DATADM1/1.D-02/,DM2/1.D-02/,PLATO/0.4D0/,CENTR/0.4D0/
      END
