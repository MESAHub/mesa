      SubroutineOpacit
      Implicitreal*8(a-h,o-z)
      PARAMETER(NVARS=3)
      include '../obj/nfreq_and_mzone.inc'
      PARAMETER(NYDIM=(NVARS+2*NFREQ)*Mzon,MAXDER=4)
      Parameter(Is=5)
      PARAMETER(NZ=3000000)
      Parameter(Nstage=28,Natom=15)
      PARAMETER(KOMAX=80)
      LogicalLSYSTEM
      Parameter(LSystem=.FALSE.)
      Parameter(Pi=3.1415926535897932d+00,hPlanc=1.0545716280D-27,Cs=2.9979245800D+10,Boltzk=1.3806504000D-16,Avogar=6.0221417900D+2
     *3,AMbrun=1.6605387832D-24,AMelec=9.1093821500D-28,echarg=4.8032042700D-10,CG=6.6742800000D-08,CMS=1.9884000000D+33,RSol=6.9551
     *000000D+10,ULGR=1.4000000000D+01,UPURS=1.0000000000D+07,ULGPU=7.0000000000D+00,ULGEU=1.3000000000D+01,UPC=3.0856776000D+18,UTP
     *=1.0000000000D+05,URHO=1.0000000000D-06,CARAD=7.5657680191D-15,CSIGM=5.6704004778D-05,ERGEV=1.6021764864D-12,GRADeV=1.16045052
     *85D+04,RADC=7.5657680191D-02,CTOMP=4.0062048575D-01,CCAPS=2.6901213726D+01,CCAPZ=9.8964034725D+00)
      IntegerZn(Natom),ZnCo(Natom+1)
      DimensionAZ(Natom)
      Common/AZZn/AZ,Zn,ZnCo
      Parameter(DUSTK=1.d1,TpDust=0.02d0,Cneutr=0.020D0)
      LogicalRadP
      COMMON/RadP/RadP
      COMMON/ARG/TP,PL,CHEM,LST,KENTR,JURS
      COMMON/RESULT/P,Egas,Sgas,ENG,CAPPA,PT,ET,ST,ENGT,CAPT,NZR
      COMMON/ABUND/XYZA,Yat(Natom)
      COMMON/AZ/AS,ZS,SCN
      COMMON/STR/PPL,EPL,SPL,ENGPL,CAPPL,CP,GAM,DA,DPE,DSE,DSP,BETgas
      COMMON/XELECT/XE,XET,XEPL,PE,Ycomp
      COMMON/URScap/Tpsqrt,Psicap,Scap,ScapT,ScapPl,ZMean,YZMean,ZMT,ZMPl,YZMT,YZMPl
      COMMON/capab/Capab
      Wcap=Ccaps*Pl*(Scap+Cneutr*(Yat(1)+Cneutr*Yat(2)))/(Tp**2*Tpsqrt)
      ZCap=CcapZ*(ZMean+2.D0)**2*YZMean*Pl/(Tp**2*Tpsqrt)
      Capab=Wcap*Xe+ZCap
      If(Tp.LT.TpDust)Capab=Capab+DustK*(TpDust-Tp)**2
      Cappa=Capab+CTOMP*Xe
      CapT=XeT*(Wcap+CTOMP)+(Ccaps*Xe*ScapT+CcapZ*(ZMean+2.D0)*(2.D0*ZMT*YZMean+(ZMean+2.D0)*YZMT))*Pl/(Tp**2*Tpsqrt)-3.5D0*(Wcap*Xe
     *+ZCap)/Tp
      If(Tp.LT.TpDust)CapT=CapT-2.d0*DustK*(TpDust-Tp)
      CapPl=XePl*(Wcap+CTOMP)+(Ccaps*Xe*ScapPl+CcapZ*(ZMean+2.D0)*(2.D0*ZMPl*YZMean+(ZMean+2.D0)*YZMPl))*Pl/(Tp**2*Tpsqrt)+(Wcap*Xe+
     *ZCap)
      return
      end
