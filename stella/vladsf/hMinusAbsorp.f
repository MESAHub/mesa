      subroutinehMinusAbsorp(T,wLength,pTypeAbsrb,K_res)
      implicitnone
      Real*8T,wLength,K_res
      integerpTypeAbsrb
      Real*8calc_K_bf_wl,calc_K_ff_wl
      K_res=333.33
      if(pTypeAbsrb.eq.1)then
      K_res=calc_K_bf_wl(T,wLength,pTypeAbsrb)+calc_K_ff_wl(T,wLength)
      endif
      if(pTypeAbsrb.eq.2.or.pTypeAbsrb.eq.4)then
      K_res=calc_K_bf_wl(T,wLength,pTypeAbsrb)
      endif
      if(pTypeAbsrb.eq.3)then
      K_res=calc_K_ff_wl(T,wLength)
      endif
      RETURN
      endsubroutine
      functioncalc_K_ff_wl(l_T,l_wLength)result(K_ff_wl)
      Real*8l_T,T5040,l_wLength
      Real*8K_ff_wl,ff_func_sum
      Dimensionff_An_g(6),ff_Bn_g(6),ff_Cn_g(6),ff_Dn_g(6),ff_En_g(6),ff_Fn_g(6)
      Dimensionff_An_s(6),ff_Bn_s(6),ff_Cn_s(6),ff_Dn_s(6),ff_En_s(6),ff_Fn_s(6)
      Dataff_An_s/518.1021,473.2636,-482.2089,115.5291,0.0,0.0/
      Dataff_Bn_s/-734.8666,1443.4137,-737.1616,169.6374,0.0,0.0/
      Dataff_Cn_s/1021.1775,-1977.3395,1096.8827,-245.649,0.0,0.0/
      Dataff_Dn_s/-479.0721,922.3575,-521.1341,114.2430,0.0,0.0/
      Dataff_En_s/93.1373,-178.9275,101.7963,-21.9972,0.0,0.0/
      Dataff_Fn_s/-6.4285,12.36,-7.0571,1.5097,0.0,0.0/
      Dataff_An_g/0.0,2483.3460,-3449.8890,2200.04,-696.271,88.283/
      Dataff_Bn_g/0.0,285.827,-1158.382,2427.719,-1841.4,444.517/
      Dataff_Cn_g/0.0,-2054.291,8746.523,-13651.105,8624.97,-1863.864/
      Dataff_Dn_g/0.0,2827.776,-11485.632,16755.524,-10051.53,2095.288/
      Dataff_En_g/0.0,-1341.537,5303.6090,-7510.494,4400.067,-901.788/
      Dataff_Fn_g/0.0,208.952,-812.939,1132.738,-655.02,132.985/
      if(l_wLength.LE.0.182d0.or.l_T.LE.0)then
      	K_ff_wl=0.d0
      return
      endif
      T5040=5040.d0/l_T
      if(T5040.LT.0.5.or.T5040.GT.3.6)then
      	K_ff_wl=0.d0
      return
      endif
      ff_func_sum=0
      if(l_wLength.LT.0.3645d0)then
      doi=1,6
      ff_func_sum=ff_func_sum+T5040**(n/2+0.5d0)*(l_wLength**2*ff_An_s(i)+ff_Bn_s(i)+ff_Cn_s(i)/l_wLength+ff_Dn_s(i)/(l_wLength**2)+
     *ff_En_s(i)/(l_wLength**3)+ff_Fn_s(i)/(l_wLength**4))
      enddo
      else
      doi=1,6
      ff_func_sum=ff_func_sum+T5040**(n/2+0.5d0)*(l_wLength**2*ff_An_g(i)+ff_Bn_g(i)+ff_Cn_g(i)/l_wLength+ff_Dn_g(i)/(l_wLength**2)+
     *ff_En_g(i)/(l_wLength**3)+ff_Fn_g(i)/(l_wLength**4))
      enddo
      endif
      K_ff_wl=1.d-29*ff_func_sum
      return
      endfunction
      functioncalc_K_bf_wl(l_T,l_wLength,typeReturn)result(K_bf_wl)
      Real*8::l_T,l_wLength
      Integer::typeReturn
      Real*8K_bf_wl,bf_sigma_lambda,bf_func_sum
      Parameter(bf_alpha=1.439d4)
      Parameter(bf_lambda0=1.6419d0)
      Dimensionbf_Cn(6)
      Databf_Cn/152.519,49.534,-118.858,92.536,-34.194,4.982/
      if(l_T.LE.0.or.l_wLength.LT.0.125d0.or.l_wLength.GT.1.6419)then
      	K_bf_wl=0.d0
      return
      endif
      bf_func_sum=0.d0
      doi=1,6
      bf_func_sum=bf_func_sum+bf_Cn(i)*((1/l_wLength-1/bf_lambda0)**(i/2.d0-0.5d0))
      enddo
      bf_sigma_lambda=1.d-18*l_wLength**3*((1/l_wLength-1/bf_lambda0)**1.5)*bf_func_sum
      if(typeReturn.EQ.4)then
      	K_bf_wl=bf_sigma_lambda
      return
      endif
      K_bf_wl=0.750*l_T**(-2.5d0)*(exp(bf_alpha/(bf_lambda0*l_T)))*(1.d0-exp(-bf_alpha/(l_wLength*l_T)))*bf_sigma_lambda
      return
      endfunction
